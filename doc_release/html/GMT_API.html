<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    

    <title>1. Introduction &mdash; GMT 5.1.2 documentation</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>


    
    <link rel="stylesheet" href="_static/rtd.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '5.1.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/searchtools.js"></script>
    <script type="text/javascript" src="_static/rtd-sidebar.js"></script>
    <link rel="top" title="GMT 5.1.2 documentation" href="index.html" />
    <link rel="up" title="GMT_API" href="api.html" />
    <link rel="prev" title="GMT_API" href="api.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="api.html" title="GMT_API"
             accesskey="P">previous</a> </li>
  <li><a href="/projects/gmt/wiki/Documentation">Project Home</a>  &raquo;</li>
  
        <li><a href="index.html">GMT 5.1.2 documentation</a> &raquo;</li>

          <li><a href="api.html" accesskey="U">GMT_API</a> &raquo;</li>
<li class="right">
<form class="search" accept-charset="UTF-8" action="search.html" method="get">
  <div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"></div>
  <label for="q">
    <a class="search" href="search.html" accesskey="s" original-title="">Search:</a>
  </label>
  <input accesskey="f" class="small" id="q" name="q" size="20" type="text">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form></li>
   

      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <p><strong>The Generic Mapping Tools</strong></p>
<p><strong>C/C++ Application Programming Interface</strong></p>
<p><strong>Pål (Paul) Wessel</strong></p>
<p><strong>SOEST, University of Hawai&#8217;i at Manoa</strong></p>
<p><strong>Walter H. F. Smith</strong></p>
<p><strong>Laboratory for Satellite Altimetry, NOAA/NESDIS/STAR</strong></p>
<p><strong>Remko Scharroo</strong></p>
<p><strong>EUMETSAT, Darmstadt, Germany</strong></p>
<p><strong>Joaquim F. Luis</strong></p>
<p><strong>Universidade do Algarve, Faro, Portugal</strong></p>
<p><strong>Florian Wobbe</strong></p>
<p><strong>Alfred Wegener Institute, Germany</strong></p>
<div class="section" id="introduction">
<h1>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="preamble">
<span id="index-0"></span><h2>1.1. Preamble<a class="headerlink" href="#preamble" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/GMT4_mode.png"><img alt="_images/GMT4_mode.png" src="_images/GMT4_mode.png" style="width: 506.5px; height: 267.5px;" /></a>
<p class="caption">GMT 4 programs contain all the high-level functionality.</p>
</div>
<p>Prior to version 5, the bulk of GMT functionality was coded directly
in the standard GMT C program modules (e.g., <tt class="docutils literal"><span class="pre">surface.c</span></tt>, <tt class="docutils literal"><span class="pre">psxy.c</span></tt>, <tt class="docutils literal"><span class="pre">grdimage.c</span></tt>, etc.). The
GMT library only offered access to low-level functions from which
those high-level GMT programs were built. The standard GMT programs
have been very successful, with tens of thousands of users world-wide.
However, the design of the main programs prevented developers from
leveraging GMT functionality from within other programming
environments since access to GMT tools could only be achieved via
system calls <a class="footnote-reference" href="#id7" id="id1">[1]</a>. Consequently, all data i/o had to be done via
temporary files. The design also prevented the GMT developers
themselves from taking advantage of these modules directly. For
instance, the tool <a class="reference internal" href="pslegend.html"><em>pslegend</em></a> needed to
make extensive use of system calls to <a class="reference internal" href="psxy.html"><em>psxy</em></a> and
<a class="reference internal" href="pstext.html"><em>pstext</em></a> in order to plot the lines,
symbols and text that make up a map legend, making it a very awkward
program to maintain.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/GMT5_mode.png"><img alt="_images/GMT5_mode.png" src="_images/GMT5_mode.png" style="width: 506.5px; height: 284.5px;" /></a>
<p class="caption">GMT 5 programs contain all the high-level functionality.</p>
</div>
<p>Starting with GMT version 5, all standard GMT programs have been
split into a short driver program (the &#8220;new&#8221; GMT  programs) and a
function &#8220;module&#8221;. The drivers simply call the corresponding
GMT modules; it is these modules that do all the work. These new
functions have been placed in a new GMT high-level API library and can
be called from a variety of environments (C/C++, Fortran, Julia, Python,
Matlab, Visual Basic, R, etc.) <a class="footnote-reference" href="#id8" id="id2">[2]</a>. For example, the main
program <tt class="docutils literal"><span class="pre">blockmean.c</span></tt> has been reconfigured as a high-level function
<tt class="docutils literal"><span class="pre">GMT_blockmean()</span></tt>, which does the actual spatial averaging and can
pass the result back to the calling program (or write it to file). The
previous behavior of <tt class="docutils literal"><span class="pre">blockmean.c</span></tt> is replicated by a short driver program that simply
collects user arguments and then calls <tt class="docutils literal"><span class="pre">GMT_blockmean()</span></tt>. Indeed, the
driver programs for all the standard GMT programs are identical so
that the makefile generates them on-the-fly when it compiles and links
them with the GMT library into executables. Thus, <tt class="docutils literal"><span class="pre">blockmean.c</span></tt> and others do in
fact no longer exist.</p>
</div>
<div class="section" id="the-i-o-abstraction-layer">
<h2>1.2. The i/o abstraction layer<a class="headerlink" href="#the-i-o-abstraction-layer" title="Permalink to this headline">¶</a></h2>
<p>In order for this interface to be as flexible as possible we have
generalized the notion of input and output. Data that already reside in
an application&#8217;s memory may serve as input to a GMT function. Other
sources of input may be file pointers and file descriptors (as well as
the already-supported mechanism for passing file names). For standard
data table i/o, the GMT API takes care of the task of assembling any
combination of files, pointers, and memory locations into <em>a single
virtual data set</em> from which the GMT function may read (a) all
records at once into memory, or (b) read one record at a time. Likewise,
GMT functions may write their output to a virtual destination, which
might be a memory location in the user&#8217;s application, a file pointer or
descriptor, or an output file. The GMT functions are unaware of these
details and simply read from a &#8220;source&#8221; and write to a &#8220;destination&#8221;.</p>
</div>
<div class="section" id="our-audience">
<h2>1.3. Our audience<a class="headerlink" href="#our-audience" title="Permalink to this headline">¶</a></h2>
<p>Here, we document the new functions in the GMT API library for
application developers who wish to call these functions from their own
custom programs. At this point, only the new high-level GMT API is
fully documented and intended for public use. The structure and
documentation of the under-lying lower-level GMT library is not
finalized. Developers using these functions may risk disruption to their
programs due to changes we may make in the library in support of the
GMT API. However, developers who wish to make supplemental packages to
be distributed as part of GMT will (other than talk to us) probably
want to access the entire low-level GMT library as well. It is
unlikely that the low-level library will ever be fully documented.</p>
</div>
<div class="section" id="definitions">
<h2>1.4. Definitions<a class="headerlink" href="#definitions" title="Permalink to this headline">¶</a></h2>
<p>For the purpose of this documentation a few definitions are needed:</p>
<ol class="arabic simple">
<li>&#8220;Standard GMT program&#8221; refers to one of the traditional stand-alone
command-line executables known to all GMT users, e.g.,
<a class="reference internal" href="blockmean.html"><em>blockmean</em></a>, <a class="reference internal" href="psxy.html"><em>psxy</em></a>,
<a class="reference internal" href="grdimage.html"><em>grdimage</em></a>, etc. Prior to version 5,
these were the only GMT executables available.</li>
<li>&#8220;GMT module&#8221; refers to the function in the GMT API library that
is responsible for all the action taken by the corresponding
GMT program. All such modules are given the same name as the
corresponding program but carry the prefix <tt class="docutils literal"><span class="pre">GMT_</span></tt>, e.g.,
<tt class="docutils literal"><span class="pre">GMT_blockmean</span></tt>.</li>
<li>&#8220;GMT application&#8221; refers to a new application written by any
developer and may call one or more GMT functions to create a new
GMT-compatible executable.</li>
<li>In the API description that follows we will use the type <tt class="docutils literal"><span class="pre">int</span></tt> to
mean a 4-byte integer. All integers used in the API are 4-byte
integers with the exception of one function where a longer integer is
used. Since different operating systems have their own way of
defining 8-byte integers we use C99&#8217;s <tt class="docutils literal"><span class="pre">int64_t</span></tt> for this purpose;
it is guaranteed to yield the correct type that the GMT function
expect.</li>
</ol>
<p>In version 5, the standard GMT programs are themselves specific but
overly simple examples of GMT applications that only call the single
GMT function they are associated with. However, some programs such as
<a class="reference internal" href="pslegend.html"><em>pslegend</em></a>, <a class="reference internal" href="gmtconvert.html"><em>gmtconvert</em></a>,
<a class="reference internal" href="grdblend.html"><em>grdblend</em></a>,
<a class="reference internal" href="grdfilter.html"><em>grdfilter</em></a> and others call several modules.</p>
</div>
<div class="section" id="recognized-resources">
<h2>1.5. Recognized resources<a class="headerlink" href="#recognized-resources" title="Permalink to this headline">¶</a></h2>
<p>The GMT API knows how to read and write five types of data common to
GMT operations: CPT palette tables, data tables (ASCII or binary),
text tables, GMT grids and images (reading only). In addition, we
present two data types to facilitate the passing of simple user arrays
(one or more equal-length data columns of any data type, e.g., double,
char) and 2-D or 3-D user matrices (of any data type and column/row
organization <a class="footnote-reference" href="#id9" id="id3">[3]</a>). We refer to these data types as GMT <em>resources</em>.
There are many attributes for each of these resources and therefore we
use a top-level structure for each type to keep them all in one
container. These containers are given or returned by the GMT API
functions using opaque pointers (<tt class="docutils literal"><span class="pre">void</span> <span class="pre">*</span></tt>). Below we discuss these
containers in some detail; we will later present how they are used when
importing or exporting them to or from files, memory locations, or
streams. The first five are the standard GMT objects, while the latter
two are the special user data containers to facilitate passing user
data into and out of GMT modules. These resources are defined in the include
file <tt class="docutils literal"><span class="pre">gmt_resources.h</span></tt>; please consult this file to ensure correctness
in case the documentation is not up-to-date.</p>
<div class="section" id="data-tables">
<h3>1.5.1. Data tables<a class="headerlink" href="#data-tables" title="Permalink to this headline">¶</a></h3>
<p>Much data processed in GMT come in the form of ASCII, netCDF, or
native binary data tables. These may have any number of header records
(ASCII files only) and perhaps segment headers. GMT programs will read
one or more such tables when importing data. However, to avoid memory
duplication or data limitations some programs may prefer to read records one
at the time. The GMT API has functions that let you read
record-by-record by presenting a virtual data set that combines all the
data tables specified as input. This simplifies record processing
considerably. A <tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_DATASET</span></tt> may contain any number of tables,
each with any number of segments, each segment with any number of
records, and each record with any number of columns. Thus, the arguments
to GMT API functions that handle such data sets expect this type of
variable. All segments are expected to have the same number of columns.</p>
<div class="highlight-c" id="struct-dataset"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_DATASET</span> <span class="p">{</span> <span class="cm">/* Single container for an array of GMT tables (files) */</span>
    <span class="cm">/* Variables we document for the API: */</span>
    <span class="kt">uint64_t</span>               <span class="n">n_tables</span><span class="p">;</span>     <span class="cm">/* The total number of tables (files) contained */</span>
    <span class="kt">uint64_t</span>               <span class="n">n_columns</span><span class="p">;</span>    <span class="cm">/* The number of data columns */</span>
    <span class="kt">uint64_t</span>               <span class="n">n_segments</span><span class="p">;</span>   <span class="cm">/* The total number of segments across all tables */</span>
    <span class="kt">uint64_t</span>               <span class="n">n_records</span><span class="p">;</span>    <span class="cm">/* The total number of data records across all tables */</span>
    <span class="kt">double</span>                <span class="o">*</span><span class="n">min</span><span class="p">;</span>          <span class="cm">/* Minimum coordinate for each column */</span>
    <span class="kt">double</span>                <span class="o">*</span><span class="n">max</span><span class="p">;</span>          <span class="cm">/* Maximum coordinate for each column */</span>
    <span class="k">struct</span> <span class="n">GMT_DATATABLE</span> <span class="o">**</span><span class="n">table</span><span class="p">;</span>        <span class="cm">/* Pointer to array of tables */</span>
    <span class="cm">/* ---- Variables &quot;hidden&quot; from the API ---- */</span>
    <span class="kt">uint64_t</span>               <span class="n">id</span><span class="p">;</span>           <span class="cm">/* The internal number of the data set */</span>
    <span class="kt">size_t</span>                 <span class="n">n_alloc</span><span class="p">;</span>      <span class="cm">/* The current allocation length of tables */</span>
    <span class="kt">uint64_t</span>               <span class="n">dim</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>       <span class="cm">/* Only used by GMT_Duplicate_Data to override dimensions */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>           <span class="n">geometry</span><span class="p">;</span>     <span class="cm">/* The geometry of this dataset */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>           <span class="n">alloc_level</span><span class="p">;</span>  <span class="cm">/* The level it was allocated at */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_dest</span>     <span class="n">io_mode</span><span class="p">;</span>      <span class="cm">/* -1 means write OGR format (requires proper -a),</span>
<span class="cm">                                            0 means write everything to one destination [Default],</span>
<span class="cm">                                            1 means use table-&gt;file[GMT_OUT] to write separate table,</span>
<span class="cm">                                            2 means use segment-&gt;file[GMT_OUT] to write separate segments.</span>
<span class="cm">                                            3 is same as 2 but with no filenames we create filenames from</span>
<span class="cm">                                              tbl and seg numbers */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_alloc</span>    <span class="n">alloc_mode</span><span class="p">;</span>   <span class="cm">/* Allocation mode [GMT_ALLOCATED_BY_GMT] */</span>
    <span class="kt">char</span>                  <span class="o">*</span><span class="n">file</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>      <span class="cm">/* Name of file or source [0 = in, 1 = out] */</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="text-tables">
<h3>1.5.2. Text tables<a class="headerlink" href="#text-tables" title="Permalink to this headline">¶</a></h3>
<p>Some data needed by GMT are simply free-form ASCII text tables. In many respects these
are handled similarly to data tables. E.g., they may have any number of
header records and even segment headers, and GMT programs can read one
or more tables or get text records one at the time. A
<tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_TEXTSET</span></tt> may contain any number of tables, each with any
number of segments, and each segment with any number of records. Thus,
the arguments to GMT API functions that handle such data sets expect
this type of variable. The user&#8217;s program may then parse and process
such text records as required. This resources is particularly useful
when your data consist of a mix or data coordinates and ordinary text
since regular data tables will be parsed for floating-point columns
only.</p>
<div class="highlight-c" id="struct-textset"><div class="highlight"><pre>struct GMT_TEXTSET { /* Single container for an array of GMT text tables (files) */
    /* Variables we document for the API: */
    uint64_t               n_tables;     /* The total number of tables (files) contained */
    uint64_t               n_segments;   /* The total number of segments across all tables */
    uint64_t               n_records;    /* The total number of data records across all tables */
    struct GMT_TEXTTABLE **table;        /* Pointer to array of tables */
    /* ---- Variables &quot;hidden&quot; from the API ---- */
    uint64_t               id;           /* The internal number of the data set */
    size_t                 n_alloc;      /* The current allocation length of tables */
    unsigned int           geometry;     /* The geometry of this dataset */
    unsigned int           alloc_level;  /* The level it was allocated at */
    enum GMT_enum_dest     io_mode;      /* -1 means write OGR format (requires proper -a),
                                            0 means write everything to one destination [Default],
                                            1 means use table-&gt;file[GMT_OUT] to write separate table,
                                            2 means use segment-&gt;file[GMT_OUT] to write separate segments.
                                            3 is same as 2 but with no filenames we create filenames */
                                              from tbl and seg numbers */
    enum GMT_enum_alloc    alloc_mode;   /* Allocation mode [GMT_ALLOCATED_BY_GMT] */
    char                  *file[2];      /* Name of file or source [0 = in, 1 = out] */
};
</pre></div>
</div>
</div>
<div class="section" id="gmt-grids">
<h3>1.5.3. GMT grids<a class="headerlink" href="#gmt-grids" title="Permalink to this headline">¶</a></h3>
<p>GMT grids are used to represent equidistant and organized 2-D
surfaces. These can be plotted as contour maps, color images, or as
perspective surfaces. Because the native GMT grid is simply a 1-D
float array with all the metadata kept in a separate header, we pass
this information via a <tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_GRID</span></tt>, which is a container that
holds both items. Thus, the arguments to GMT API functions that handle
GMT grids expect this type of variable.</p>
<div class="highlight-c" id="struct-grid"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_GRID</span> <span class="p">{</span>                        <span class="cm">/* To hold a GMT float grid and its header in one container */</span>
    <span class="k">struct</span> <span class="n">GMT_GRID_HEADER</span> <span class="o">*</span><span class="n">header</span><span class="p">;</span>      <span class="cm">/* Pointer to full GMT header for the grid */</span>
    <span class="kt">float</span>                  <span class="o">*</span><span class="n">data</span><span class="p">;</span>        <span class="cm">/* Pointer to the float grid */</span>
    <span class="cm">/* ---- Variables &quot;hidden&quot; from the API ---- */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>            <span class="n">id</span><span class="p">;</span>          <span class="cm">/* The internal number of the grid */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>            <span class="n">alloc_level</span><span class="p">;</span> <span class="cm">/* The level it was allocated at */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_alloc</span>     <span class="n">alloc_mode</span><span class="p">;</span>  <span class="cm">/* Allocation mode [GMT_ALLOCATED_BY_GMT] */</span>
    <span class="kt">void</span>                   <span class="o">*</span><span class="n">extra</span><span class="p">;</span>       <span class="cm">/* Row-by-row machinery information [NULL] */</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="gmt-images">
<h3>1.5.4. GMT images<a class="headerlink" href="#gmt-images" title="Permalink to this headline">¶</a></h3>
<p>GMT images are used to represent bit-mapped images typically obtained
via the GDAL bridge. These can be reprojected internally, such as when
used in grdimage. Since images and grids share the concept of a header,
we use the same header structure for grids as for images; however, some
additional metadata attributes are also needed. Finally, the image
itself may be of any data type and have more than one band (channel).
Both image and header information are passed via a <tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_IMAGE</span></tt>,
which is a container that holds both items. Thus, the arguments to
GMT API functions that handle GMT images expect this type of
variable. Unlike the other objects, writting images has only partial
support via <tt class="docutils literal"><span class="pre">GMT_grdimage</span></tt> <a class="footnote-reference" href="#id10" id="id4">[4]</a>.</p>
<div class="highlight-c" id="struct-image"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_IMAGE</span> <span class="p">{</span>
    <span class="k">enum</span> <span class="n">GMT_enum_type</span>      <span class="n">type</span><span class="p">;</span>           <span class="cm">/* Data type, e.g. GMT_FLOAT */</span>
    <span class="kt">int</span>                    <span class="o">*</span><span class="n">ColorMap</span><span class="p">;</span>       <span class="cm">/* Array with color lookup values */</span>
    <span class="k">struct</span> <span class="n">GMT_GRID_HEADER</span> <span class="o">*</span><span class="n">header</span><span class="p">;</span>         <span class="cm">/* Pointer to full GMT header for the image */</span>
    <span class="kt">unsigned</span> <span class="kt">char</span>          <span class="o">*</span><span class="n">data</span><span class="p">;</span>           <span class="cm">/* Pointer to actual image */</span>
    <span class="cm">/* ---- Variables &quot;hidden&quot; from the API ---- */</span>
    <span class="kt">uint64_t</span>                <span class="n">id</span><span class="p">;</span>             <span class="cm">/* The internal number of the data set */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>            <span class="n">alloc_level</span><span class="p">;</span>    <span class="cm">/* Level of initial allocation */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_alloc</span>     <span class="n">alloc_mode</span><span class="p">;</span>     <span class="cm">/* Allocation info [0] */</span>
    <span class="k">const</span> <span class="kt">char</span>             <span class="o">*</span><span class="n">ColorInterp</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="cpt-palette-tables">
<h3>1.5.5. CPT palette tables<a class="headerlink" href="#cpt-palette-tables" title="Permalink to this headline">¶</a></h3>
<p>The color palette table files, or just CPT tables, contain colors and
patterns used for plotting data such as surfaces (i.e., GMT grids) or
symbols, lines and polygons (i.e., GMT tables). GMT programs will
generally read in a CPT palette table, make it the current palette, do
the plotting, and destroy the table when done. The information is
referred to via a pointer to <tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_PALETTE</span></tt>. Thus, the arguments
to GMT API functions that handle palettes expect this type of
variable. It is not expected that users will wish to manipulate a CPT
table directly, but rather use this mechanism to hold them in memory and
pass as arguments to GMT modules.</p>
<div class="highlight-c" id="struct-palette"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_PALETTE</span> <span class="p">{</span>         <span class="cm">/* Holds all pen, color, and fill-related parameters */</span>
    <span class="cm">/* Variables we document for the API: */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">n_headers</span><span class="p">;</span>          <span class="cm">/* Number of CPT file header records (0 if no header) */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">n_colors</span><span class="p">;</span>           <span class="cm">/* Number of colors in CPT lookup table */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">cpt_flags</span><span class="p">;</span>          <span class="cm">/* Flags controling use of BFN colors */</span>
    <span class="k">struct</span> <span class="n">GMT_LUT</span>       <span class="o">*</span><span class="n">range</span><span class="p">;</span>              <span class="cm">/* CPT lookup table read by GMT_read_cpt */</span>
    <span class="k">struct</span> <span class="n">GMT_BFN_COLOR</span>  <span class="n">patch</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>           <span class="cm">/* Structures with back/fore/nan colors */</span>
    <span class="kt">char</span> <span class="o">**</span><span class="n">header</span><span class="p">;</span>                            <span class="cm">/* Array with all CPT file header records, if any) */</span>
    <span class="cm">/* ---- Variables &quot;hidden&quot; from the API ---- */</span>
    <span class="kt">uint64_t</span>              <span class="n">id</span><span class="p">;</span>                 <span class="cm">/* The internal number of the data set */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_alloc</span>   <span class="n">alloc_mode</span><span class="p">;</span>         <span class="cm">/* Allocation mode [GMT_ALLOCATED_BY_GMT] */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">alloc_level</span><span class="p">;</span>        <span class="cm">/* The level it was allocated at */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">model</span><span class="p">;</span>              <span class="cm">/* RGB, HSV, CMYK */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">is_gray</span><span class="p">;</span>            <span class="cm">/* true if only grayshades are needed */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">is_bw</span><span class="p">;</span>              <span class="cm">/* true if only black and white are needed */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">is_continuous</span><span class="p">;</span>      <span class="cm">/* true if continuous color tables have been given */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">has_pattern</span><span class="p">;</span>        <span class="cm">/* true if cpt file contains any patterns */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">skip</span><span class="p">;</span>               <span class="cm">/* true if current z-slice is to be skipped */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">categorical</span><span class="p">;</span>        <span class="cm">/* true if CPT applies to categorical data */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">z_adjust</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>        <span class="cm">/* 1 if +u&lt;unit&gt; was parsed and scale set, 3 if z has been adjusted, 0 otherwise */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">z_mode</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>          <span class="cm">/* 1 if +U&lt;unit&gt; was parsed, 0 otherwise */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>          <span class="n">z_unit</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>          <span class="cm">/* Unit enum specified via +u&lt;unit&gt; */</span>
    <span class="kt">double</span>                <span class="n">z_unit_to_meter</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="cm">/* Scale, given z_unit, to convert z from &lt;unit&gt; to meters */</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="user-data-columns-gmt-vectors">
<h3>1.5.6. User data columns (GMT vectors)<a class="headerlink" href="#user-data-columns-gmt-vectors" title="Permalink to this headline">¶</a></h3>
<p>Programs that wish to call GMT modules may hold data in their own
particular data structures. For instance, the user&#8217;s program may have
three column arrays of type float and wishes to use these as the input
source to the <tt class="docutils literal"><span class="pre">GMT_surface</span></tt> module, which normally expects double
precision triplets via a <tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_DATASET</span></tt> read from a file or
given by memory reference. Simply create a new <tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_VECTOR</span></tt>
(see section <a class="reference internal" href="#sec-create"><em>Create empty resources</em></a>) and assign the union array pointers (see
<a class="reference internal" href="#struct-univector"><em>univector</em></a>) to your data columns and provide the required
information on length, data types, and optionally range (see
<a class="reference internal" href="#struct-vector"><em>GMT_VECTOR</em></a>). By letting the GMT module know you are passing a
data set <em>via</em> a <tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_VECTOR</span></tt> it will know how to read the data correctly.</p>
<div class="highlight-c" id="struct-univector"><div class="highlight"><pre><span class="k">union</span> <span class="n">GMT_UNIVECTOR</span> <span class="p">{</span>
    <span class="kt">uint8_t</span>  <span class="o">*</span><span class="n">uc1</span><span class="p">;</span>       <span class="cm">/* Pointer for unsigned 1-byte array */</span>
    <span class="kt">int8_t</span>   <span class="o">*</span><span class="n">sc1</span><span class="p">;</span>       <span class="cm">/* Pointer for signed 1-byte array */</span>
    <span class="kt">uint16_t</span> <span class="o">*</span><span class="n">ui2</span><span class="p">;</span>       <span class="cm">/* Pointer for unsigned 2-byte array */</span>
    <span class="kt">int16_t</span>  <span class="o">*</span><span class="n">si2</span><span class="p">;</span>       <span class="cm">/* Pointer for signed 2-byte array */</span>
    <span class="kt">uint32_t</span> <span class="o">*</span><span class="n">ui4</span><span class="p">;</span>       <span class="cm">/* Pointer for unsigned 4-byte array */</span>
    <span class="kt">int32_t</span>  <span class="o">*</span><span class="n">si4</span><span class="p">;</span>       <span class="cm">/* Pointer for signed 4-byte array */</span>
    <span class="kt">uint64_t</span> <span class="o">*</span><span class="n">ui8</span><span class="p">;</span>       <span class="cm">/* Pointer for unsigned 8-byte array */</span>
    <span class="kt">int64_t</span>  <span class="o">*</span><span class="n">si8</span><span class="p">;</span>       <span class="cm">/* Pointer for signed 8-byte array */</span>
    <span class="kt">float</span>    <span class="o">*</span><span class="n">f4</span><span class="p">;</span>        <span class="cm">/* Pointer for float array */</span>
    <span class="kt">double</span>   <span class="o">*</span><span class="n">f8</span><span class="p">;</span>        <span class="cm">/* Pointer for double array */</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Table 1.1: Definition of the <tt class="docutils literal"><span class="pre">GMT_UNIVECTOR</span></tt> union that holds a pointer to any array type.</p>
<div class="highlight-c" id="struct-vector"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_VECTOR</span> <span class="p">{</span>
    <span class="kt">uint64_t</span>             <span class="n">n_columns</span><span class="p">;</span>     <span class="cm">/* Number of vectors */</span>
    <span class="kt">uint64_t</span>             <span class="n">n_rows</span><span class="p">;</span>        <span class="cm">/* Number of rows in each vector */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_reg</span>    <span class="n">registration</span><span class="p">;</span>  <span class="cm">/* 0 for gridline and 1 for pixel registration */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_type</span>  <span class="o">*</span><span class="n">type</span><span class="p">;</span>          <span class="cm">/* Array with data type for each vector */</span>
    <span class="k">union</span> <span class="n">GMT_UNIVECTOR</span> <span class="o">*</span><span class="n">data</span><span class="p">;</span>          <span class="cm">/* Array with unions for each column */</span>
    <span class="kt">double</span>               <span class="n">range</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>      <span class="cm">/* The min and max limits on t-range (or 0,0) */</span>
    <span class="kt">char</span> <span class="n">command</span><span class="p">[</span><span class="n">GMT_GRID_COMMAND_LEN320</span><span class="p">];</span> <span class="cm">/* name of generating command */</span>
    <span class="kt">char</span> <span class="n">remark</span><span class="p">[</span><span class="n">GMT_GRID_REMARK_LEN160</span><span class="p">];</span>   <span class="cm">/* comments re this data set */</span>
    <span class="cm">/* ---- Variables &quot;hidden&quot; from the API ---- */</span>
    <span class="kt">uint64_t</span>             <span class="n">id</span><span class="p">;</span>            <span class="cm">/* An identification number */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>         <span class="n">alloc_level</span><span class="p">;</span>   <span class="cm">/* Level of initial allocation */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_alloc</span>  <span class="n">alloc_mode</span><span class="p">;</span>    <span class="cm">/* Determines if we may free the vectors or not */</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="user-data-matrices-gmt-matrices">
<h3>1.5.7. User data matrices (GMT matrices)<a class="headerlink" href="#user-data-matrices-gmt-matrices" title="Permalink to this headline">¶</a></h3>
<p>Likewise, programs may have an integer 2-D matrix in memory and wish to
use that as the input grid to the <tt class="docutils literal"><span class="pre">GMT_grdfilter</span></tt> module, which
normally expects a <tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_GRID</span></tt> with floating point data via a
file or provided by memory reference. As for user vectors, we create a
<tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_MATRIX</span></tt> (see <a class="reference internal" href="#sec-create"><em>Create empty resources</em></a>), assign the appropriate
union pointer to your data matrix and provide information on dimensions
and data type. Let the GMT module know you
are passing a grid via a <tt class="docutils literal"><span class="pre">struct</span> <span class="pre">GMT_MATRIX</span></tt> and it will know how to
read the matrix properly.</p>
<div class="highlight-c" id="struct-matrix"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_MATRIX</span> <span class="p">{</span>
    <span class="kt">uint64_t</span>             <span class="n">n_rows</span><span class="p">;</span>        <span class="cm">/* Number of rows in the matrix */</span>
    <span class="kt">uint64_t</span>             <span class="n">n_columns</span><span class="p">;</span>     <span class="cm">/* Number of columns in the matrix */</span>
    <span class="kt">uint64_t</span>             <span class="n">n_layers</span><span class="p">;</span>      <span class="cm">/* Number of layers in a 3-D matrix */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_fmt</span>    <span class="n">shape</span><span class="p">;</span>         <span class="cm">/* 0 = C (rows) and 1 = Fortran (cols) */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_reg</span>    <span class="n">registration</span><span class="p">;</span>  <span class="cm">/* 0 for gridline and 1 for pixel registration  */</span>
    <span class="kt">size_t</span>               <span class="n">dim</span><span class="p">;</span>           <span class="cm">/* Allocated length of longest C or Fortran dim */</span>
    <span class="kt">size_t</span>               <span class="n">size</span><span class="p">;</span>          <span class="cm">/* Byte length of data */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_type</span>   <span class="n">type</span><span class="p">;</span>          <span class="cm">/* Data type, e.g. GMT_FLOAT */</span>
    <span class="kt">double</span>               <span class="n">range</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>      <span class="cm">/* Contains xmin/xmax/ymin/ymax[/zmin/zmax] */</span>
    <span class="k">union</span> <span class="n">GMT_UNIVECTOR</span>  <span class="n">data</span><span class="p">;</span>          <span class="cm">/* Union with pointer to actual matrix of the chosen type */</span>
    <span class="kt">char</span> <span class="n">command</span><span class="p">[</span><span class="n">GMT_GRID_COMMAND_LEN320</span><span class="p">];</span> <span class="cm">/* name of generating command */</span>
    <span class="kt">char</span> <span class="n">remark</span><span class="p">[</span><span class="n">GMT_GRID_REMARK_LEN160</span><span class="p">];</span>   <span class="cm">/* comments re this data set */</span>
    <span class="cm">/* ---- Variables &quot;hidden&quot; from the API ---- */</span>
    <span class="kt">uint64_t</span>             <span class="n">id</span><span class="p">;</span>            <span class="cm">/* The internal number of the data set */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span>         <span class="n">alloc_level</span><span class="p">;</span>   <span class="cm">/* The level it was allocated at */</span>
    <span class="k">enum</span> <span class="n">GMT_enum_alloc</span>  <span class="n">alloc_mode</span><span class="p">;</span>    <span class="cm">/* Allocation mode [GMT_ALLOCATED_BY_GMT] */</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">enum</span></tt> types referenced in <a class="reference internal" href="#struct-vector"><em>GMT_VECTOR</em></a> and
Table <a class="reference internal" href="#struct-matrix"><em>GMT_MATRIX</em></a> and summarized in Table <a class="reference internal" href="#tbl-types"><em>types</em></a>.</p>
<table border="1" class="docutils" id="tbl-types">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">constant</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GMT_CHAR</td>
<td>int8_t, 1-byte signed integer type</td>
</tr>
<tr class="row-odd"><td>GMT_UCHAR</td>
<td>int8_t, 1-byte unsigned integer type</td>
</tr>
<tr class="row-even"><td>GMT_SHORT</td>
<td>int16_t, 2-byte signed integer type</td>
</tr>
<tr class="row-odd"><td>GMT_USHORT</td>
<td>uint16_t, 2-byte unsigned integer type</td>
</tr>
<tr class="row-even"><td>GMT_INT</td>
<td>int32_t, 4-byte signed integer type</td>
</tr>
<tr class="row-odd"><td>GMT_UINT</td>
<td>uint32_t, 4-byte unsigned integer type</td>
</tr>
<tr class="row-even"><td>GMT_LONG</td>
<td>int64_t, 8-byte signed integer type</td>
</tr>
<tr class="row-odd"><td>GMT_ULONG</td>
<td>uint64_t, 8-byte unsigned integer type</td>
</tr>
<tr class="row-even"><td>GMT_FLOAT</td>
<td>4-byte data float type</td>
</tr>
<tr class="row-odd"><td>GMT_DOUBLE</td>
<td>8-byte data float type</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="overview-of-the-gmt-c-application-program-interface">
<span id="chapter-overview"></span><h1>2. Overview of the GMT C Application Program Interface<a class="headerlink" href="#overview-of-the-gmt-c-application-program-interface" title="Permalink to this headline">¶</a></h1>
<p>Users who wish to create their own GMT application based on the API
must make sure their program goes through the steps below; details for
each step will be revealed in the following chapter. We have kept the
API simple: In addition to the GMT modules, there are only 52 public
functions to become familiar with, but most applications will only use a
small subset of this selection. Functions either return an integer error
code (when things go wrong; otherwise it is set to <tt class="docutils literal"><span class="pre">GMT_OK</span> <span class="pre">(0)</span></tt>), or they
return a void pointer to a GMT resources (or NULL if things go wrong).
In either case the API will report what the error is. The layout here
assumes you wish to use data in memory as input sources; if the data are
simply command-line files then things simplify considerably.</p>
<ol class="arabic simple">
<li>Initialize a new GMT session with <a class="reference internal" href="#gmt-create-session">GMT_Create_Session</a>, which
allocates a hidden GMT API control structure and returns an opaque
pointer to it. This pointer is the first argument to all subsequent
GMT API function calls within the session.</li>
<li>For each intended call to a GMT module, several steps are involved:<ol class="loweralpha">
<li>Register input sources and output destination with <a class="reference internal" href="#gmt-register-io">GMT_Register_IO</a>.</li>
<li>Each resource registration generates a unique ID number. For
memory resources, we embed these numbers in unique filenames of
the form &#8220;&#64;GMTAPI&#64;-######&#8221; with <a class="reference internal" href="#gmt-encode-id">GMT_Encode_ID</a>. When GMT i/o library
functions encounter such filenames they extract the ID and make a
connection to the corresponding resource. Multiple table data or text
sources are combined into a single virtual source for GMT modules to
operate on. In contrast, CPT, Grid, and Image resources are
operated on individually.</li>
<li>Enable data import once all registrations are complete
(<a class="reference internal" href="#sec-res-init"><em>Resources init</em></a>).</li>
<li>Read data into memory. You may choose to read everything at once
or read record-by-record.</li>
<li>Prepare required arguments and call the GMT module you wish to use.</li>
<li>For non-mapping modules, process any results returned to memory via
pointers rather than written to files.</li>
<li>Destroy the resources allocated by GMT modules to hold results,
or let the garbage collector do this automatically at the end of
the session.</li>
</ol>
</li>
<li>Repeat steps a–f as many times as your application requires.</li>
<li>We terminate the GMT session by calling <a class="reference internal" href="#gmt-destroy-session">GMT_Destroy_Session</a>.</li>
</ol>
<p>The steps a–d collapse into a single step if data are simply read from files.</p>
<p>Advanced programs may be calling more than one GMT session and thus
run several sessions, perhaps concurrently as different threads on
multi-core machines. We will now discuss these steps in more detail.
Throughout, we will introduce upper-case GMT C enum constants <em>in
lieu</em> of simple integer constants. These are considered part of the API
and are available for developers via the <tt class="docutils literal"><span class="pre">gmt_resources.h</span></tt> include file.</p>
<p>The C/C++ API is deliberately kept small to make it easy to use.
Next table gives a list of all the functions and their purpose.</p>
<table border="1" class="docutils" id="tbl-api">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">constant</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="#gmt-append-option">GMT_Append_Option</a></td>
<td>Append new option structure to linked list</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-begin-io">GMT_Begin_IO</a></td>
<td>Enable record-by-record i/o</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-call-module">GMT_Call_Module</a></td>
<td>Call any of the GMT modules</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-create-args">GMT_Create_Args</a></td>
<td>Convert linked list of options to text array</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-create-cmd">GMT_Create_Cmd</a></td>
<td>Convert linked list of options to command line</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-create-data">GMT_Create_Data</a></td>
<td>Create an empty data resource</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-create-options">GMT_Create_Options</a></td>
<td>Convert command line options to linked list</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-create-session">GMT_Create_Session</a></td>
<td>Initialize a new GMT session</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-delete-option">GMT_Delete_Option</a></td>
<td>Delete an option structure from the linked list</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-destroy-args">GMT_Destroy_Args</a></td>
<td>Delete text array of arguments</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-destroy-cmd">GMT_Destroy_Cmd</a></td>
<td>Delete text command of arguments</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-destroy-data">GMT_Destroy_Data</a></td>
<td>Delete a data resource</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-destroy-options">GMT_Destroy_Options</a></td>
<td>Delete the linked list of option structures</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-destroy-session">GMT_Destroy_Session</a></td>
<td>Terminate a GMT session</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-duplicate-data">GMT_Duplicate_Data</a></td>
<td>Make an identical copy of a data resources</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-encode-id">GMT_Encode_ID</a></td>
<td>Encode a resources ID as a special filename</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-end-io">GMT_End_IO</a></td>
<td>Disable further record-by-record i/o</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-fft">GMT_FFT</a></td>
<td>Take the Fast Fourier Transform of data object</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-fft-1d">GMT_FFT_1D</a></td>
<td>Take the Fast Fourier Transform of 1-D float data</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-fft-2d">GMT_FFT_2D</a></td>
<td>Take the Fast Fourier Transform of 2-D float data</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-fft-create">GMT_FFT_Create</a></td>
<td>Initialize the FFT machinery</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-fft-destroy">GMT_FFT_Destroy</a></td>
<td>Terminate the FFT machinery</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-fft-option">GMT_FFT_Option</a></td>
<td>Explain the FFT options and modifiers</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-fft-parse">GMT_FFT_Parse</a></td>
<td>Parse argument with FFT options and modifiers</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-fft-wavenumber">GMT_FFT_Wavenumber</a></td>
<td>Return wavenumber given data index</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-find-option">GMT_Find_Option</a></td>
<td>Find an option in the linked list</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-get-common">GMT_Get_Common</a></td>
<td>Determine if a GMT common option was set</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-get-coord">GMT_Get_Coord</a></td>
<td>Create a coordinate array</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-get-data">GMT_Get_Data</a></td>
<td>Import a registered data resources</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-get-default">GMT_Get_Default</a></td>
<td>Obtain as string one of the GMT default settings</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-get-id">GMT_Get_ID</a></td>
<td>Obtain the ID of a given resource</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-get-index">GMT_Get_Index</a></td>
<td>Convert row, col into a grid or image index</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-get-record">GMT_Get_Record</a></td>
<td>Import a single data record</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-get-row">GMT_Get_Row</a></td>
<td>Import a single grid row</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-get-value">GMT_Get_Value</a></td>
<td>Convert string into coordinates or dimensions</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-init-io">GMT_Init_IO</a></td>
<td>Initialize i/o given registered resources</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-make-option">GMT_Make_Option</a></td>
<td>Create an option structure</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-message">GMT_Message</a></td>
<td>Issue a message, optionally with time stamp</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-option">GMT_Option</a></td>
<td>Explain one or more GMT common options</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-parse-common">GMT_Parse_Common</a></td>
<td>Parse the GMT common options</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-put-data">GMT_Put_Data</a></td>
<td>Export to a registered data resource given by ID</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-put-record">GMT_Put_Record</a></td>
<td>Export a data record</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-put-row">GMT_Put_Row</a></td>
<td>Export a grid row</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-read-data">GMT_Read_Data</a></td>
<td>Import a data resource or file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-register-io">GMT_Register_IO</a></td>
<td>Register a resources for i/o</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-report">GMT_Report</a></td>
<td>Issue a message contingent upon verbosity level</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-retrieve-data">GMT_Retrieve_Data</a></td>
<td>Obtained link to data in memory via ID</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-set-comment">GMT_Set_Comment</a></td>
<td>Assign a comment to a data resource</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-status-io">GMT_Status_IO</a></td>
<td>Check status of record-by-record i/o</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#gmt-update-option">GMT_Update_Option</a></td>
<td>Modify an option structure</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#gmt-write-data">GMT_Write_Data</a></td>
<td>Export a data resource</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-gmt-c-application-program-interface">
<h1>3. The GMT C Application Program Interface<a class="headerlink" href="#the-gmt-c-application-program-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="initialize-a-new-gmt-session">
<h2>3.1. Initialize a new GMT session<a class="headerlink" href="#initialize-a-new-gmt-session" title="Permalink to this headline">¶</a></h2>
<p>Most applications will need to initialize only a single GMT session.
This is true of all the standard GMT programs since they only call one
GMT module and then exit. Most user-developed GMT applications are
likely to only initialize one session even though they may call many
GMT modules. However, the GMT API supports any number of
simultaneous sessions should the programmer wish to take advantage of
it. This might be useful when you have access to several CPUs and want
to spread the computing load <a class="footnote-reference" href="#id11" id="id5">[5]</a>. In the following discussion we will
simplify our treatment to the use of a single session only.</p>
<p>To initiate the new session we use</p>
<blockquote id="gmt-create-session">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="nf">GMT_Create_Session</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">tag</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pad</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span>
                          <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">print_func</span><span class="p">)</span> <span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">));</span>
</pre></div>
</div>
</div></blockquote>
<p>and you will typically call it thus:</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="n">API</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="n">API</span> <span class="o">=</span> <span class="n">GMT_Create_Session</span> <span class="p">(</span><span class="s">&quot;Session name&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <a class="reference internal" href="#struct-api"><em>API</em></a> is an opaque pointer to the hidden GMT API control
structure. You will need to pass this pointer to <em>all</em> subsequent
GMT API functions; this is how essential internal information is
passed from module to module. The key task of this initialization is to
set up the GMT machinery and its internal variables used for map
projections, plotting, i/o, etc. The initialization also allocates space
for internal structures used to register resources. The <tt class="docutils literal"><span class="pre">pad</span></tt> argument
sets how many rows and columns should be used as padding for grids and
images so that boundary conditions can be applied. GMT uses 2 so we
recommend that value. The <tt class="docutils literal"><span class="pre">mode</span></tt> argument is only used for external APIs
that need to replace GMT&#8217;s calls to a hard exit upon failure with a soft return. Likewise,
the <tt class="docutils literal"><span class="pre">print_func</span></tt> argument is a pointer to a function that is used to print
messages via <a class="reference internal" href="#gmt-message">GMT_Message</a> or <a class="reference internal" href="#gmt-report">GMT_Report</a> from APIs that cannot use the
standard printf (this is the case for the Matlab API, for instance).
All other uses should simply pass 0 and NULL for these two arguments.
Should something go wrong then <tt class="docutils literal"><span class="pre">API</span></tt> will be returned as <tt class="docutils literal"><span class="pre">NULL</span></tt>.</p>
<div class="highlight-c" id="struct-api"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMTAPI_CTRL</span> <span class="p">{</span>
    <span class="cm">/* Master controller which holds all GMT API related information at run-time for a single session.</span>
<span class="cm">     * Users can run several GMT sessions concurrently; each session requires its own structure.</span>
<span class="cm">     * Use GMTAPI_Create_Session to initialize a new session and GMTAPI_Destroy_Session to end it. */</span>
    <span class="kt">uint64_t</span>     <span class="n">current_rec</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>    <span class="cm">/* Current record number &gt;= 0 in the combined virtual dataset (in and out) */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n_objects</span><span class="p">;</span>         <span class="cm">/* Number of currently active input and output data objects */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">unique_ID</span><span class="p">;</span>         <span class="cm">/* Used to create unique IDs for duration of session */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">session_ID</span><span class="p">;</span>        <span class="cm">/* ID of this session */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">unique_var_ID</span><span class="p">;</span>     <span class="cm">/* Used to create unique object IDs (grid,dataset, etc) for duration of session */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">current_item</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>   <span class="cm">/* Array number of current dataset being processed (in and out)*/</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pad</span><span class="p">;</span>               <span class="cm">/* Session default for number of rows/cols padding for grids [2] */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">;</span>              <span class="cm">/* 1 if called via external API (Matlab, Python) [0] */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">leave_grid_scaled</span><span class="p">;</span> <span class="cm">/* 1 if we dont want to unpack a grid after we packed it for writing [0] */</span>
    <span class="kt">bool</span>         <span class="n">registered</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>     <span class="cm">/* true if at least one source/destination has been registered (in and out) */</span>
    <span class="kt">bool</span>         <span class="n">io_enabled</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>     <span class="cm">/* true if access has been allowed (in and out) */</span>
    <span class="kt">size_t</span>       <span class="n">n_objects_alloc</span><span class="p">;</span>   <span class="cm">/* Allocation counter for data objects */</span>
    <span class="kt">int</span>          <span class="n">error</span><span class="p">;</span>             <span class="cm">/* Error code from latest API call [GMT_OK] */</span>
    <span class="kt">int</span>          <span class="n">last_error</span><span class="p">;</span>        <span class="cm">/* Error code from previous API call [GMT_OK] */</span>
    <span class="kt">int</span>          <span class="n">shelf</span><span class="p">;</span>             <span class="cm">/* Place to pass hidden values within API */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">io_mode</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>        <span class="cm">/* 1 if access as set, 0 if record-by-record */</span>
    <span class="k">struct</span>       <span class="n">GMT_CTRL</span> <span class="o">*</span><span class="n">GMT</span><span class="p">;</span>     <span class="cm">/* Key structure with low-level GMT internal parameters */</span>
    <span class="k">struct</span>       <span class="n">GMTAPI_DATA_OBJECT</span> <span class="o">**</span><span class="n">object</span><span class="p">;</span> <span class="cm">/* List of registered data objects */</span>
    <span class="kt">char</span>        <span class="o">*</span><span class="n">session_tag</span><span class="p">;</span>       <span class="cm">/* Name tag for this session (or NULL) */</span>
    <span class="kt">bool</span>         <span class="n">internal</span><span class="p">;</span>          <span class="cm">/* true if session was initiated by gmt.c */</span>
    <span class="kt">bool</span>         <span class="n">deep_debug</span><span class="p">;</span>        <span class="cm">/* temporary for debugging */</span>
    <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">print_func</span><span class="p">)</span> <span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">);</span> <span class="cm">/* Pointer to fprintf function (may be reset by external APIs like MEX) */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">do_not_exit</span><span class="p">;</span>       <span class="cm">/* 0 by default, meaning it is OK to call exit (otherwise call return instead) */</span>
    <span class="k">struct</span>       <span class="n">Gmt_libinfo</span> <span class="o">*</span><span class="n">lib</span><span class="p">;</span>  <span class="cm">/* List of shared libs to consider */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n_shared_libs</span><span class="p">;</span>     <span class="cm">/* How many in lib */</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="highlight-c"><div class="highlight"><pre>struct GMTAPI_DATA_OBJECT {
    /* Information for each input or output data entity, including information
     * needed while reading/writing from a table (file or array) */
    uint64_t               n_rows;            /* Number or rows in this array [GMT_DATASET and GMT_TEXTSET to/from MATRIX/VETOR only] */
    uint64_t               n_columns;         /* Number of columns to process in this dataset [GMT_DATASET only] */
    uint64_t               n_expected_fields; /* Number of expected columns for this dataset [GMT_DATASET only] */
    size_t                 n_alloc;           /* Number of items allocated so far if writing to memory */
    unsigned int           ID;                /* Unique identifier which is &gt;= 0 */
    unsigned int           alloc_level;       /* Nested module level when object was allocated */
    unsigned int           status;            /* 0 when first registered, 1 after reading/writing has started, 2 when finished */
    bool                   selected;          /* true if requested by current module, false otherwise */
    bool                   close_file;        /* true if we opened source as a file and thus need to close it when done */
    bool                   region;            /* true if wesn was passed, false otherwise */
    bool                   no_longer_owner;   /* true if the data pointed to by the object was passed on to another object */
    bool                   messenger;         /* true for output objects passed from the outside to receive data from GMT. */
                                                 If true we destroy data pointer before writing */
    enum GMT_enum_alloc    alloc_mode;        /* GMT_ALLOCATED_{BY_GMT|EXTERNALLY} */
    enum GMT_io_enum       direction;         /* GMT_IN or GMT_OUT */
    enum GMT_enum_family   family;            /* One of GMT_IS_{DATASET|TEXTSET|CPT|IMAGE|GRID|MATRIX|VECTOR|COORD} */
    enum GMT_enum_family   actual_family;     /* May be GMT_IS_MATRIX|VECTOR when one of the others are created via those */
    unsigned               method;            /* One of GMT_IS_{FILE,STREAM,FDESC,DUPLICATE,REFERENCE} or sum with enum */
                                                 GMT_enum_via (GMT_VIA_{NONE,VECTOR,MATRIX,OUTPUT}); using unsigned type
                                                 because sum exceeds enum GMT_enum_method */
    enum GMT_enum_geometry geometry;          /* One of GMT_IS_{POINT|LINE|POLY|PLP|SURFACE|NONE} */
    double wesn[GMTAPI_N_GRID_ARGS];          /* Grid domain limits */
    void                  *resource;          /* Points to registered filename, memory location, etc., where data can be */
                                                 obtained from with GMT_Get_Data. */
    void                  *data;              /* Points to GMT object that was read from a resource */
    FILE                  *fp;                /* Pointer to source/destination stream [For rec-by-rec procession, NULL if mem location] */
    char                  *filename;          /* Filename, stream, of file handle (otherwise NULL) */
    void *(*import) (struct GMT_CTRL *, FILE *, uint64_t *, int *);  /* Pointer to input function (for DATASET/TEXTSET only) */
#ifdef DEBUG
    struct GMT_GRID *G;
    struct GMT_DATASET *D;
    struct GMT_TEXTSET *T;
    struct GMT_PALETTE *C;
    struct GMT_MATRIX *M;
    struct GMT_VECTOR *V;
#endif
#ifdef HAVE_GDAL
    struct GMT_IMAGE *I;
#endif
};
</pre></div>
</div>
</div>
<div class="section" id="register-input-or-output-resources">
<h2>3.2. Register input or output resources<a class="headerlink" href="#register-input-or-output-resources" title="Permalink to this headline">¶</a></h2>
<p>When using the standard GMT programs, you specify input files on the
command line or via special program options (e.g.,
<strong>-I</strong><em>intensity.nc</em>). The output of the programs are either written
to standard output (which you redirect to files or pipe to other
programs) or to files specified by specific program options (e.g.,
<strong>-G</strong><em>output.nc</em>). Alternatively, the GMT API allows you to specify
input (and output) to be associated with open file handles or program
variables. We will examine this more closely below. Registering a
resource is a required step before attempting to import or export data
that <em>do not</em> come from files or standard input/output.</p>
<div class="section" id="resource-registration">
<h3>3.2.1. Resource registration<a class="headerlink" href="#resource-registration" title="Permalink to this headline">¶</a></h3>
<p>Registration involves a direct or indirect call to</p>
<blockquote id="gmt-register-io">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Register_IO</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">family</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">method</span><span class="p">,</span>
                     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">geometry</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">direction</span><span class="p">,</span>
                     <span class="kt">double</span> <span class="n">wesn</span><span class="p">[],</span> <span class="kt">void</span> <span class="o">*</span><span class="n">ptr</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <a class="reference internal" href="#tbl-family"><em>family</em></a> specifies what kind of resource is to be registered,
<a class="reference internal" href="#tbl-methods"><em>method</em></a> specifies
how we to access this resource (see Table <a class="reference internal" href="#tbl-methods"><em>methods</em></a> for recognized
methods), <a class="reference internal" href="#tbl-geometry"><em>geometry</em></a> specifies the geometry of the data, <tt class="docutils literal"><span class="pre">ptr</span></tt> is the address of the
pointer to the named resource. If <tt class="docutils literal"><span class="pre">direction</span></tt> is <tt class="docutils literal"><span class="pre">GMT_OUT</span></tt> and the
<tt class="docutils literal"><span class="pre">method</span></tt> is not related to a file (filename, stream, or handle), then
<tt class="docutils literal"><span class="pre">ptr</span></tt> must be NULL. After the GMT module has written the data you
can use <a class="reference internal" href="#gmt-retrieve-data">GMT_Retrieve_Data</a> to assign a pointer to the memory location
(variable) where the output was allocated. For grid (and image)
resources you may request to obtain a subset via the <a class="reference internal" href="#tbl-wesn"><em>wesn</em></a> array; otherwise, pass NULL
(or an array with at least 4 items all set to 0) to obtain the
entire grid (or image). The <tt class="docutils literal"><span class="pre">direction</span></tt> indicates input or output and
is either <tt class="docutils literal"><span class="pre">GMT_IN</span></tt> or <tt class="docutils literal"><span class="pre">GMT_OUT</span></tt>. Finally, the function returns a
unique resource ID, or <tt class="docutils literal"><span class="pre">GMT_NOTSET</span></tt> if there was an error.</p>
</div>
<div class="section" id="object-id-encoding">
<h3>3.2.2. Object ID encoding<a class="headerlink" href="#object-id-encoding" title="Permalink to this headline">¶</a></h3>
<p>To use registered resources as program input or output arguments you
must pass them via a text string that acts as a special file name
(Chapter <a class="reference internal" href="#chapter-overview"><em>Overview</em></a>). The proper filename formatting is guaranteed by
using the function</p>
<blockquote id="gmt-encode-id">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Encode_ID</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">filename</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ID</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which accepts the unique <tt class="docutils literal"><span class="pre">ID</span></tt> and writes the corresponding
<tt class="docutils literal"><span class="pre">filename</span></tt>. The variable <tt class="docutils literal"><span class="pre">filename</span></tt> must have enough space to hold
16 bytes. The function returns 1 if there is an error; otherwise
it returns 0.</p>
<table border="1" class="docutils" id="tbl-family">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">family</th>
<th class="head">source points to</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GMT_IS_DATASET</td>
<td>A [multi-segment] table file</td>
</tr>
<tr class="row-odd"><td>GMT_IS_TEXTSET</td>
<td>A [multi-segment] text file</td>
</tr>
<tr class="row-even"><td>GMT_IS_GRID</td>
<td>A GMT grid file</td>
</tr>
<tr class="row-odd"><td>GMT_IS_CPT</td>
<td>A CPT file</td>
</tr>
<tr class="row-even"><td>GMT_IS_IMAGE</td>
<td>A GMT image</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tbl-methods">
<colgroup>
<col width="31%" />
<col width="7%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">method</th>
<th class="head">value</th>
<th class="head">how to read/write data</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GMT_IS_FILE</td>
<td>0</td>
<td>Pointer to name of a file</td>
</tr>
<tr class="row-odd"><td>GMT_IS_STREAM</td>
<td>1</td>
<td>Pointer to open stream (or process)</td>
</tr>
<tr class="row-even"><td>GMT_IS_FDESC</td>
<td>2</td>
<td>Pointer to integer file descriptor</td>
</tr>
<tr class="row-odd"><td>GMT_IS_DUPLICATE</td>
<td>3</td>
<td>Pointer to memory we may <em>duplicate</em> data from</td>
</tr>
<tr class="row-even"><td>GMT_IS_REFERENCE</td>
<td>4</td>
<td>Pointer to memory we may <em>reference</em> data from</td>
</tr>
<tr class="row-odd"><td>GMT_IS_DUPLICATE_VIA_VECTOR</td>
<td>103</td>
<td>Pointer to memory we may <em>duplicate</em> data from via vectors</td>
</tr>
<tr class="row-even"><td>GMT_IS_REFERENCE_VIA_VECTOR</td>
<td>104</td>
<td>Pointer to memory we may <em>reference</em> data from via vectors</td>
</tr>
<tr class="row-odd"><td>GMT_IS_DUPLICATE_VIA_MATRIX</td>
<td>203</td>
<td>Pointer to memory we may <em>duplicate</em> data from via a matrix</td>
</tr>
<tr class="row-even"><td>GMT_IS_REFERENCE_VIA_MATRIX</td>
<td>204</td>
<td>Pointer to memory we may <em>reference</em> data from via a matrix</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tbl-via">
<colgroup>
<col width="23%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">approach</th>
<th class="head">how method is modified</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GMT_VIA_VECTOR</td>
<td>User&#8217;s data columns are accessed via a GMT_VECTOR structure</td>
</tr>
<tr class="row-odd"><td>GMT_VIA_MATRIX</td>
<td>User&#8217;s matrix is accessed via a GMT_MATRIX structure</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tbl-geometry">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">geometry</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GMT_IS_TEXT</td>
<td>Not a geographic item</td>
</tr>
<tr class="row-odd"><td>GMT_IS_POINT</td>
<td>Multi-dimensional point data</td>
</tr>
<tr class="row-even"><td>GMT_IS_LINE</td>
<td>Geographic or Cartesian line segments</td>
</tr>
<tr class="row-odd"><td>GMT_IS_POLYGON</td>
<td>Geographic or Cartesian closed polygons</td>
</tr>
<tr class="row-even"><td>GMT_IS_SURFACE</td>
<td>2-D gridded surface</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="tbl-wesn">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">index</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GMT_XLO</td>
<td>x_min (west) boundary of grid subset</td>
</tr>
<tr class="row-odd"><td>GMT_XHI</td>
<td>x_max (east) boundary of grid subset</td>
</tr>
<tr class="row-even"><td>GMT_YLO</td>
<td>y_min (south) boundary of grid subset</td>
</tr>
<tr class="row-odd"><td>GMT_YHI</td>
<td>y_max (north) boundary of grid subset</td>
</tr>
<tr class="row-even"><td>GMT_ZLO</td>
<td>z_min (bottom) boundary of 3-D matrix subset</td>
</tr>
<tr class="row-odd"><td>GMT_ZHI</td>
<td>z_max (top) boundary of 3-D matrix subset</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="resource-initialization">
<span id="sec-res-init"></span><h3>3.2.3. Resource initialization<a class="headerlink" href="#resource-initialization" title="Permalink to this headline">¶</a></h3>
<p>All GMT programs dealing with input or output files given on the
command line, and perhaps defaulting to the standard input or output
streams if no files are given, must call the i/o initializer function
<a class="reference internal" href="#gmt-init-io">GMT_Init_IO</a> once for each direction required (i.e., input and output
separately). For input it determines how many input sources have already
been registered. If none has been registered then it scans the program
arguments for any filenames given on the command line and register these
input resources. Finally, if we still have found no input sources we
assign the standard input stream as the single input source. For output
it is similar: If no single destination has been registered we specify
the standard output stream as the output destination. Only one main
output destination is allowed to be active when a module writes data
(some modules also write additional output via program-specific
options). The prototype for this function is</p>
<blockquote id="gmt-init-io">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Init_IO</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">family</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">geometry</span><span class="p">,</span>
                 <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">direction</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span>
                 <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n_args</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">args</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <a class="reference internal" href="#tbl-family"><em>family</em></a> specifies what kind of resource is to be registered,
<a class="reference internal" href="#tbl-geometry"><em>geometry</em></a> specifies the geometry of the data, <tt class="docutils literal"><span class="pre">direction</span></tt> is either
<tt class="docutils literal"><span class="pre">GMT_IN</span></tt> or <tt class="docutils literal"><span class="pre">GMT_OUT</span></tt>, and <tt class="docutils literal"><span class="pre">mode</span></tt> is a bit flag that determines
what we do if no resources have been registered. The choices are</p>
<blockquote>
<div><p><strong>GMT_ADD_FILES_IF_NONE</strong> (1) means &#8220;add command line (option)
files if none have been registered already&#8221;</p>
<p><strong>GMT_ADD_FILES_ALWAYS</strong> (2) means &#8220;always add any command line files&#8221;</p>
<p><strong>GMT_ADD_STDIO_IF_NONE</strong> (4) means &#8220;add std* if no other
input/output have been specified&#8221;</p>
<p><strong>GMT_ADD_STDIO_ALWAYS</strong> (8) means &#8220;always add std* even if
resources have been registered&#8221;.</p>
<p><strong>GMT_ADD_EXISTING</strong> (16) means &#8220;only use already registered resources&#8221;.</p>
</div></blockquote>
<p>The standard behavior is <tt class="docutils literal"><span class="pre">GMT_REG_DEFAULT</span></tt> (5). Next, <tt class="docutils literal"><span class="pre">n_args</span></tt> is 0
if <tt class="docutils literal"><span class="pre">args</span></tt> is the head of a linked list of options (further discussed
in <a class="reference internal" href="#sec-func"><em>Prepare modules opts</em></a>); otherwise <tt class="docutils literal"><span class="pre">args</span></tt> is an array of <tt class="docutils literal"><span class="pre">n_args</span></tt>
strings (i.e., the int argc, char *argv[] model)</p>
<p>Many programs will register an export location where results of a
GMT function (say, a filtered grid) should be returned, but may then
wish to use that variable as an <em>input</em> resource in a subsequent module
call. This is accomplished by re-registering the resource as an <em>input</em>
source, thereby changing the <em>direction</em> of the data set. The function
returns 1 if there is an error; otherwise it returns 0.</p>
</div>
<div class="section" id="dimension-parameters-for-user-1-d-column-vectors">
<h3>3.2.4. Dimension parameters for user 1-D column vectors<a class="headerlink" href="#dimension-parameters-for-user-1-d-column-vectors" title="Permalink to this headline">¶</a></h3>
<p>We refer to Table <a class="reference internal" href="#struct-vector"><em>vector</em></a>. The <tt class="docutils literal"><span class="pre">type</span></tt> array must hold the data
type of each data column in the user&#8217;s program. All types other than
GMT_DOUBLE will be converted internally in GMT to <tt class="docutils literal"><span class="pre">double</span></tt>, thus
possibly increasing memory requirements. If the type is <tt class="docutils literal"><span class="pre">GMT_DOUBLE</span></tt> then
GMT will be able to use the column directly by reference. The
<tt class="docutils literal"><span class="pre">n_columns</span></tt> and <tt class="docutils literal"><span class="pre">n_rows</span></tt> parameters indicate the number of vectors
and their common length. For output these may not yet be known so you should
pass 0 for these values.</p>
</div>
<div class="section" id="dimension-parameters-for-user-2-d-table-arrays">
<h3>3.2.5. Dimension parameters for user 2-D table arrays<a class="headerlink" href="#dimension-parameters-for-user-2-d-table-arrays" title="Permalink to this headline">¶</a></h3>
<p>We refer to Table <a class="reference internal" href="#struct-matrix"><em>matrix</em></a>. The <tt class="docutils literal"><span class="pre">type</span></tt> parameter specifies the
data type used for the array in the user&#8217;s program. All types other than
GMT_FLOAT will be converted internally in GMT to <tt class="docutils literal"><span class="pre">float</span></tt>, thus
possibly increasing memory requirements. If the type is <tt class="docutils literal"><span class="pre">GMT_FLOAT</span></tt> then
GMT may be able to use the matrix directly by reference. The
<tt class="docutils literal"><span class="pre">n_rows</span></tt> and <tt class="docutils literal"><span class="pre">n_columns</span></tt> parameters indicate the dimensions of the
matrix. If these are not yet known you may pass 0 for these values and
set <tt class="docutils literal"><span class="pre">alloc_mode</span></tt> to <tt class="docutils literal"><span class="pre">GMT_ALLOCATED_BY_GMT</span></tt>; this will make sure GMT will
allocate the necessary memory at the location you specify. Fortran users
will instead have to specify a size large enough to hold the anticipated
output data. The <tt class="docutils literal"><span class="pre">registration</span></tt> and <tt class="docutils literal"><span class="pre">range</span></tt> gives the grid
registration and domain. Finally, use <tt class="docutils literal"><span class="pre">dim</span></tt> to indicate if the memory
matrix has a dimension that exceeds that of the leading row (or column)
dimension. Note: For <tt class="docutils literal"><span class="pre">GMT_IS_TEXTSET</span></tt> the user matrix is expected to be
a 2-D character array with a fixed row length of <tt class="docutils literal"><span class="pre">dim</span></tt> but we only
consider the first <tt class="docutils literal"><span class="pre">n_columns</span></tt> characters. For data grids you will
also need to specify the <tt class="docutils literal"><span class="pre">registration</span></tt> (see the GMT Cookbook and
Reference, <a class="reference internal" href="GMT_Docs.html#app-file-formats"><em>B. GMT File Formats</em></a> for description of the two forms of registration)
and data domain <tt class="docutils literal"><span class="pre">range</span></tt>.</p>
</div>
</div>
<div class="section" id="create-empty-resources">
<span id="sec-create"></span><h2>3.3. Create empty resources<a class="headerlink" href="#create-empty-resources" title="Permalink to this headline">¶</a></h2>
<p>If your application needs to build and populate GMT resources in ways
that do not depend on external resources (files, memory locations,
etc.), then you can obtain a &#8220;blank slate&#8221; by calling</p>
<blockquote id="gmt-create-data">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="n">GMT_Create_Data</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">family</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">geometry</span><span class="p">,</span>
                       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">uint64_t</span> <span class="n">par</span><span class="p">[],</span> <span class="kt">double</span> <span class="o">*</span><span class="n">wesn</span><span class="p">,</span>
                       <span class="kt">double</span> <span class="o">*</span><span class="n">inc</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">registration</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pad</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>which returns a pointer to the allocated resource. Pass <a class="reference internal" href="#tbl-family"><em>family</em></a> as
one of <tt class="docutils literal"><span class="pre">GMT_IS_GRID</span></tt>, <tt class="docutils literal"><span class="pre">GMT_IS_IMAGE</span></tt>, <tt class="docutils literal"><span class="pre">GMT_IS_DATASET</span></tt>,
<tt class="docutils literal"><span class="pre">GMT_IS_TEXTSET</span></tt>, or <tt class="docutils literal"><span class="pre">GMT_IS_CPT</span></tt>, or via the modifiers <tt class="docutils literal"><span class="pre">GMT_IS_VECTOR</span></tt>
or <tt class="docutils literal"><span class="pre">GMT_IS_MATRIX</span></tt> when handling user data. Also pass a compatible
<a class="reference internal" href="#tbl-geometry"><em>geometry</em></a>. Depending on the family and your particular way of
representing dimensions you may pass the additional parameters in one of
two ways:</p>
<ol class="arabic simple">
<li>Actual integer dimensions of items needed.</li>
<li>Physical distances and increments of each dimension.</li>
</ol>
<p>For the first case pass <tt class="docutils literal"><span class="pre">wesn</span></tt>, <tt class="docutils literal"><span class="pre">inc</span></tt> as NULL (or arrays with elements all set to 0),
and pass the <tt class="docutils literal"><span class="pre">par</span></tt> array as indicated below:</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>GMT_IS_GRID</strong></dt>
<dd>An empty <a class="reference internal" href="#struct-grid"><em>GMT_GRID</em></a> structure with a header is allocated; the data
array is NULL. The <tt class="docutils literal"><span class="pre">par</span></tt> argument is not used. Here <tt class="docutils literal"><span class="pre">wesn</span></tt> and <tt class="docutils literal"><span class="pre">inc</span></tt> can
be NULL but than <strong>-R</strong> and <strong>-I</strong> must have been set because they are inquired to
get the necessary info. If they were not set, than <tt class="docutils literal"><span class="pre">wesn</span></tt> and <tt class="docutils literal"><span class="pre">inc</span></tt> must in
fact be transmitted.</dd>
<dt><strong>GMT_IS_IMAGE</strong></dt>
<dd>Same as <strong>GMT_IS_GRID</strong> above but return an empty <a class="reference internal" href="#struct-image"><em>GMT_IMAGE</em></a></dd>
<dt><strong>GMT_IS_DATASET</strong></dt>
<dd>An empty <a class="reference internal" href="#struct-dataset"><em>GMT_DATASET</em></a> structure consisting of <tt class="docutils literal"><span class="pre">par[0]</span></tt> tables,
each with <tt class="docutils literal"><span class="pre">par[1]</span></tt> segments, each with <tt class="docutils literal"><span class="pre">par[2]</span></tt> rows, all
with <tt class="docutils literal"><span class="pre">par[3]</span></tt> columns, is allocated.
The <tt class="docutils literal"><span class="pre">wesn</span></tt>, <tt class="docutils literal"><span class="pre">inc</span></tt>, and <tt class="docutils literal"><span class="pre">registration</span></tt> argument are ignored.  The <tt class="docutils literal"><span class="pre">data</span></tt> argument should be NULL.</dd>
<dt><strong>GMT_IS_TEXTSET</strong></dt>
<dd>An empty <a class="reference internal" href="#struct-textset"><em>GMT_TEXTSET</em></a> structure consisting of <tt class="docutils literal"><span class="pre">par[0]</span></tt> tables,
each with <tt class="docutils literal"><span class="pre">par[1]</span></tt> segments, all with <tt class="docutils literal"><span class="pre">par[2]</span></tt> text records (rows), is allocated.
The <tt class="docutils literal"><span class="pre">wesn</span></tt>, <tt class="docutils literal"><span class="pre">inc</span></tt>, and <tt class="docutils literal"><span class="pre">registration</span></tt> argument are ignored.  The <tt class="docutils literal"><span class="pre">data</span></tt> argument should be NULL.</dd>
<dt><strong>GMT_IS_CPT</strong></dt>
<dd>An empty <a class="reference internal" href="#struct-palette"><em>GMT_PALETTE</em></a> structure with <tt class="docutils literal"><span class="pre">par[0]</span></tt> palette entries is allocated.
The <tt class="docutils literal"><span class="pre">wesn</span></tt>, <tt class="docutils literal"><span class="pre">inc</span></tt>, and <tt class="docutils literal"><span class="pre">registration</span></tt> argument are ignored.  The <tt class="docutils literal"><span class="pre">data</span></tt> argument should be NULL.</dd>
<dt><strong>GMT_IS_VECTOR</strong></dt>
<dd>An empty <a class="reference internal" href="#struct-vector"><em>GMT_VECTOR</em></a> structure with <tt class="docutils literal"><span class="pre">par[0]</span></tt> column entries is allocated.
The <tt class="docutils literal"><span class="pre">wesn</span></tt>, <tt class="docutils literal"><span class="pre">inc</span></tt>, and <tt class="docutils literal"><span class="pre">registration</span></tt> argument are ignored.  The <tt class="docutils literal"><span class="pre">data</span></tt> argument should be NULL.</dd>
<dt><strong>GMT_IS_MATRIX</strong></dt>
<dd>An empty <a class="reference internal" href="#struct-matrix"><em>GMT_MATRIX</em></a> structure is allocated. <tt class="docutils literal"><span class="pre">par[2]</span></tt> indicates
the number of layers for a 3-D matrix, or pass 0, 1, or NULL for a 2-D matrix.  Here,
par[0] is the number of columns while par[1] has the number of rows.  The <tt class="docutils literal"><span class="pre">data</span></tt> argument should be NULL.</dd>
</dl>
</div></blockquote>
<p>For the second approach, you
instead pass <tt class="docutils literal"><span class="pre">wesn</span></tt>, <tt class="docutils literal"><span class="pre">inc</span></tt>, and <tt class="docutils literal"><span class="pre">registration</span></tt> and leave <tt class="docutils literal"><span class="pre">par</span></tt> as NULL
(or with all elements equal 0).
For grids and images you may pass <tt class="docutils literal"><span class="pre">pad</span></tt> to set the padding, or -1 to
accept the GMT default. The <tt class="docutils literal"><span class="pre">mode</span></tt> determines what is actually
allocated when you have chosen grids or images. As for <a class="reference internal" href="#gmt-read-data">GMT_Read_Data</a>
you can pass <tt class="docutils literal"><span class="pre">GMT_GRID_ALL</span></tt> to initialize the header and allocate
space for the array; here <tt class="docutils literal"><span class="pre">data</span></tt> must be NULL. Alternatively, you can pass
<tt class="docutils literal"><span class="pre">GMT_GRID_HEADER_ONLY</span></tt> to just initialize the grid or image header,
and call a second time, passing <tt class="docutils literal"><span class="pre">GMT_GRID_DATA_ONLY</span></tt>, to allocate
space for the array. In that second call you pass the pointer returned
by the first call as <tt class="docutils literal"><span class="pre">data</span></tt> and specify the family; all other
arguments should be NULL or 0. Normally, resources created by this
function are considered to be input (i.e., have a direction that is <tt class="docutils literal"><span class="pre">GMT_IN</span></tt>).
The exception to this is for vectors and matrices which will have a direction
set to <tt class="docutils literal"><span class="pre">GMT_OUT</span></tt> when the dimensions specified are not complete (i.e., the
row dimension of vectors is 0 and both dimensions are zero for matrices).
The function returns a pointer to the
data container. In case of an error we return a NULL pointer and pass an
error code via <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>.</p>
</div>
<div class="section" id="duplicate-resources">
<h2>3.4. Duplicate resources<a class="headerlink" href="#duplicate-resources" title="Permalink to this headline">¶</a></h2>
<p>Often you have read or created a data resource and then need an
identical copy, presumably to make modifications to. Or, you want a copy
with the same dimensions and allocated memory, except data values should
not be duplicated. Alternatively, perhaps you just want to duplicate the
header and skip the allocation and duplication of the data. These tasks
are addressed by</p>
<blockquote id="gmt-duplicate-data">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="nf">GMT_Duplicate_Data</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">family</span><span class="p">,</span>
                          <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which returns a pointer to the allocated resource. Specify which
<a class="reference internal" href="#tbl-family"><em>family</em></a> and select <tt class="docutils literal"><span class="pre">mode</span></tt> from <tt class="docutils literal"><span class="pre">GMT_DUPLICATE_DATA</span></tt>,
<tt class="docutils literal"><span class="pre">GMT_DUPLICATE_ALLOC</span></tt>, and <tt class="docutils literal"><span class="pre">GMT_DUPLICATE_NONE</span></tt>, as discussed above
(also see <tt class="docutils literal"><span class="pre">mode</span></tt> discussion above). For datasets and textsets you can
add modifiers <tt class="docutils literal"><span class="pre">GMT_ALLOC_VERTICAL</span></tt> or <tt class="docutils literal"><span class="pre">GMT_ALLOC_HORIZONTAL</span></tt> if you
wish to put all data in a single long table or to paste all tables
side-by-side, respectively (thus getting one wide table instead).
Additional note for datasets: Normally we allocate the output given the
corresponding input dimensions. You can override these by specifying your
alternative dimensions in the input dataset variable dim[].
The <tt class="docutils literal"><span class="pre">data</span></tt> is a pointer to the resource you wish to duplicate. In case
of an error we return a NULL pointer and pass an error code via
<tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>.</p>
</div>
<div class="section" id="get-resource-id">
<h2>3.5. Get resource ID<a class="headerlink" href="#get-resource-id" title="Permalink to this headline">¶</a></h2>
<p>Resources created by these two methods can be used as in various ways.
Sometimes you want to pass them as input to other modules, in which
case you need to registration ID of that resource. This task
are performed by</p>
<blockquote id="gmt-get-id">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="nf">GMT_Get_ID</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">family</span><span class="p">,</span>
                  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">direction</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which returns the ID number of the allocated resource. Specify which
<a class="reference internal" href="#tbl-family"><em>family</em></a> and select <tt class="docutils literal"><span class="pre">direction</span></tt> from <tt class="docutils literal"><span class="pre">GMT_IN</span></tt> or <tt class="docutils literal"><span class="pre">GMT_OUT</span></tt>.
The <tt class="docutils literal"><span class="pre">data</span></tt> is a pointer to the resource you whose ID you need. In case
of an error we return <tt class="docutils literal"><span class="pre">GMT_NOTSET</span></tt> and pass an error code via
<tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>.</p>
</div>
<div class="section" id="import-data">
<h2>3.6. Import Data<a class="headerlink" href="#import-data" title="Permalink to this headline">¶</a></h2>
<p>If your main program needs to read any of the five recognized data types
(CPT files, data tables, text tables, GMT grids, or images) you will
use the <a class="reference internal" href="#gmt-get-data">GMT_Get_Data</a> or <a class="reference internal" href="#gmt-read-data">GMT_Read_Data</a> functions, which both
return entire data sets. In the case of data and text tables you may
also select record-by-record reading using the <a class="reference internal" href="#gmt-get-record">GMT_Get_Record</a>
function. As a general rule, your program development simplifies if you
can read entire resources into memory with <a class="reference internal" href="#gmt-get-data">GMT_Get_Data</a> or
<a class="reference internal" href="#gmt-read-data">GMT_Read_Data</a>.  However, if this leads to unacceptable memory usage
or if the program logic is particularly simple, you may obtain one data
record at the time via <a class="reference internal" href="#gmt-get-record">GMT_Get_Record</a>.</p>
<p>All input functions takes a parameter called <tt class="docutils literal"><span class="pre">mode</span></tt>. The <tt class="docutils literal"><span class="pre">mode</span></tt>
parameter generally has different meanings for the different data types
and will be discussed below. However, one bit setting is common to all
types: By default, you are only allowed to read a data source once; the
source is then flagged as having been read and subsequent attempts to
read from the same source will result in a warning and no reading takes
place. In the unlikely event you need to re-read a source you can
override this default behavior by adding <tt class="docutils literal"><span class="pre">GMT_IO_RESET</span></tt> to your <tt class="docutils literal"><span class="pre">mode</span></tt>
parameter. Note that this override does not apply to sources that are
streams or file handles, as it may not be possible to re-read their
contents.</p>
<div class="section" id="enable-data-import">
<h3>3.6.1. Enable Data Import<a class="headerlink" href="#enable-data-import" title="Permalink to this headline">¶</a></h3>
<p>Once all input resources have been registered, we signal the API that we
are done with the registration phase and are ready to start the actual
data import. This step is only required when reading one record at the
time. We initialize record-by-record reading by calling
<a class="reference internal" href="#gmt-begin-io">GMT_Begin_IO</a> This function enables dataset and textset
record-by-record reading and prepares the registered sources for the
upcoming import. The prototype is</p>
<blockquote id="gmt-begin-io">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Begin_IO</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">family</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">direction</span><span class="p">,</span>
                  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">header</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <a class="reference internal" href="#tbl-family"><em>family</em></a> specifies the resource type to be read or written
(only <tt class="docutils literal"><span class="pre">GMT_IS_DATASET</span></tt> and <tt class="docutils literal"><span class="pre">GMT_IS_TEXTSET</span></tt> are
available for record-by-record handling). The <tt class="docutils literal"><span class="pre">direction</span></tt> is either
<tt class="docutils literal"><span class="pre">GMT_IN</span></tt> or <tt class="docutils literal"><span class="pre">GMT_OUT</span></tt>, so for import we obviously use <tt class="docutils literal"><span class="pre">GMT_IN</span></tt>. The
function determines the first input source and sets up procedures for
skipping to the next input source in a virtual data set. The
<a class="reference internal" href="#gmt-get-record">GMT_Get_Record</a> function will not be able to read any data before
<a class="reference internal" href="#gmt-begin-io">GMT_Begin_IO</a> has been called. As you might guess, there is a
companion <a class="reference internal" href="#gmt-end-io">GMT_End_IO</a> function that completes, then disables
record-by-record data access. You can use these several times to switch
modes between registering data resources, doing the importing/exporting,
and disabling further data access, perhaps to do more registration. We
will discuss <a class="reference internal" href="#gmt-end-io">GMT_End_IO</a> once we are done with the data import. The
<tt class="docutils literal"><span class="pre">mode</span></tt> option is used to allow output to write table header
information (<tt class="docutils literal"><span class="pre">GMT_HEADER_ON</span></tt>) or not (<tt class="docutils literal"><span class="pre">GMT_HEADER_OFF</span></tt>). This is
usually on unless you are writing messages and other non-data. The final
<tt class="docutils literal"><span class="pre">header</span></tt> argument determines if the common header-block should be
written during initialization; choose between <tt class="docutils literal"><span class="pre">GMT_HEADER_ON</span></tt> and
<tt class="docutils literal"><span class="pre">GMT_HEADER_OFF</span></tt>. The function returns 1 if there is an
error; otherwise it returns 0.</p>
</div>
<div class="section" id="import-a-data-set">
<h3>3.6.2. Import a data set<a class="headerlink" href="#import-a-data-set" title="Permalink to this headline">¶</a></h3>
<p>If your program needs to import any of the five recognized data types
(CPT table, data table, text table, GMT grid, or image) you will use
either the <a class="reference internal" href="#gmt-read-data">GMT_Read_Data</a> or <a class="reference internal" href="#gmt-get-data">GMT_Get_Data</a> functions. The former
is typically used when reading from files, streams (e.g., <tt class="docutils literal"><span class="pre">stdin</span></tt>), or
an open file handle, while the latter is only used with a registered
resource via its unique ID. Because of the similarities of these five
import functions we use an generic form that covers all of them.</p>
<div class="section" id="import-from-a-file-stream-or-handle">
<h4>3.6.2.1. Import from a file, stream, or handle<a class="headerlink" href="#import-from-a-file-stream-or-handle" title="Permalink to this headline">¶</a></h4>
<p>To read an entire resource from a file, stream, or file handle, use</p>
<blockquote id="gmt-read-data">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="nf">GMT_Read_Data</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">family</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">method</span><span class="p">,</span>
                     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">geometry</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">double</span> <span class="n">wesn</span><span class="p">[],</span>
                     <span class="kt">char</span> <span class="o">*</span><span class="n">input</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">ptr</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><a class="reference internal" href="#gmt-create-session"><em>API</em></a></li>
<li><a class="reference internal" href="#tbl-family"><em>family</em></a></li>
<li><a class="reference internal" href="#tbl-methods"><em>method</em></a></li>
<li><a class="reference internal" href="#tbl-geometry"><em>geometry</em></a></li>
<li>mode &#8211; <em>see below</em></li>
<li><a class="reference internal" href="#tbl-wesn"><em>wesn</em></a></li>
<li>input &#8211; a pointer to char holding the file name to read.</li>
<li>ptr &#8211; NULL or the pointer returned by this function after a first call (when reading grids in two steps)</li>
<li>Return: Pointer to data container, or NULL if there were errors (passed back via API-&gt;error)</li>
</ul>
<p>where <tt class="docutils literal"><span class="pre">ptr</span></tt> is NULL except when reading grids in two steps (i.e.,
first get a grid structure with a header, then read the data). Most of
these arguments have been discussed earlier. This function can be called
in three different situations:</p>
<ol class="arabic simple">
<li>If you have a single source (filename, stream pointer, etc.) you can
call <a class="reference internal" href="#gmt-read-data">GMT_Read_Data</a> directly; there is no need to first register
the source with <a class="reference internal" href="#gmt-register-io">GMT_Register_IO</a> or gather the sources with
<a class="reference internal" href="#gmt-init-io">GMT_Init_IO</a>. However, if you did register a single source you can
still pass it via an encoded filename (see <a class="reference internal" href="#gmt-encode-id">GMT_Encode_ID</a>) or you
can instead use <a class="reference internal" href="#gmt-get-data">GMT_Get_Data</a> using the integer ID directly (see
next section).</li>
<li>If you want to specify <tt class="docutils literal"><span class="pre">stdin</span></tt> as source then use <tt class="docutils literal"><span class="pre">input</span></tt> as NULL.</li>
<li>If you already registered all desired sources with <a class="reference internal" href="#gmt-init-io">GMT_Init_IO</a>
then you indicate this by passing <tt class="docutils literal"><span class="pre">geometry</span></tt> = 0.</li>
</ol>
<p>Space will be allocated to hold the results, if needed, and a pointer to
the object is returned. If there are errors we simply return NULL and
report the error. The <tt class="docutils literal"><span class="pre">mode</span></tt> parameter has different meanings for
different data types.</p>
<dl class="docutils">
<dt><strong>CPT table</strong></dt>
<dd><tt class="docutils literal"><span class="pre">mode</span></tt> contains bit-flags that control how the CPT file&#8217;s back-,
fore-, and NaN-colors should be initialized. Select 0 to use the CPT
file&#8217;s back-, fore-, and NaN-colors, 2 to replace these with the
GMT default values, or 4 to replace them with the color table&#8217;s
entries for highest and lowest value.</dd>
<dt><strong>Data table</strong></dt>
<dd><tt class="docutils literal"><span class="pre">mode</span></tt> is currently not used.</dd>
<dt><strong>Text table</strong></dt>
<dd><tt class="docutils literal"><span class="pre">mode</span></tt> is currently not used.</dd>
<dt><strong>GMT grid</strong></dt>
<dd>Here, <tt class="docutils literal"><span class="pre">mode</span></tt> determines how we read the grid: To read the entire
grid and its header, pass <tt class="docutils literal"><span class="pre">GMT_GRID_ALL</span></tt>. However, if you need to
extract a sub-region you must first read the header by passing
<tt class="docutils literal"><span class="pre">GMT_GRID_HEADER_ONLY</span></tt>, then examine the header structure range
attributes and to specify a subset via the array <tt class="docutils literal"><span class="pre">wesn</span></tt>, and
finally call <a class="reference internal" href="#gmt-read-data">GMT_Read_Data</a> a second time, now with <tt class="docutils literal"><span class="pre">mode</span></tt> =
<tt class="docutils literal"><span class="pre">GMT_GRID_DATA_ONLY</span></tt> and passing your <tt class="docutils literal"><span class="pre">wesn</span></tt> array and the grid
structure returned from the first call as <tt class="docutils literal"><span class="pre">ptr</span></tt>. In the event your
data array should be allocated to hold both the real and imaginary
parts of a complex data set you must add either
<tt class="docutils literal"><span class="pre">GMT_GRID_IS_COMPLEX_REAL</span></tt> or <tt class="docutils literal"><span class="pre">GMT_GRID_IS_COMPLEX_IMAG</span></tt> to
<tt class="docutils literal"><span class="pre">mode</span></tt> so as to allow for the extra memory needed and to stride
the input values correctly. If your grid is huge and you must read
it row-by-row, set <tt class="docutils literal"><span class="pre">mode</span></tt> to <tt class="docutils literal"><span class="pre">GMT_GRID_HEADER_ONLY</span></tt> |
<tt class="docutils literal"><span class="pre">GMT_GRID_ROW_BY_ROW</span></tt>. You can then access the grid row-by-row
using <a class="reference internal" href="#gmt-get-row">GMT_Get_Row</a> By default the rows will be automatically
processed in order. To completely specify which row to be read, use
<tt class="docutils literal"><span class="pre">GMT_GRID_ROW_BY_ROW_MANUAL</span></tt> instead.</dd>
</dl>
</div>
<div class="section" id="import-from-a-memory-location">
<h4>3.6.2.2. Import from a memory location<a class="headerlink" href="#import-from-a-memory-location" title="Permalink to this headline">¶</a></h4>
<p>If you are importing via variables or prefer to first register the
source, then you should use <a class="reference internal" href="#gmt-get-data">GMT_Get_Data</a> instead. This function
requires fewer arguments since you simply pass the unique ID number of
the resource. The function is described as follows:</p>
<blockquote id="gmt-get-data">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="nf">GMT_Get_Data</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ID</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">ptr</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>The <tt class="docutils literal"><span class="pre">ID</span></tt> is the unique object ID you received when registering the
resource, <tt class="docutils literal"><span class="pre">mode</span></tt> controls some aspects of the import (see
<a class="reference internal" href="#gmt-read-data">GMT_Read_Data</a> above), while <tt class="docutils literal"><span class="pre">ptr</span></tt> is NULL except when reading
grids in two steps (i.e., first get a grid structure with a header, then
read the data). Other arguments have been discussed earlier. Space will
be allocated to hold the results, if needed, and a pointer to the object
is returned. If there are errors we simply return NULL and report the error.</p>
</div>
<div class="section" id="retrieve-an-allocated-result">
<h4>3.6.2.3. Retrieve an allocated result<a class="headerlink" href="#retrieve-an-allocated-result" title="Permalink to this headline">¶</a></h4>
<p>Finally, if you need to access the result that a GMT module wrote to a
memory location, then you must register an output destination with
<a class="reference internal" href="#gmt-register-io">GMT_Register_IO</a> first (passing <tt class="docutils literal"><span class="pre">ptr</span></tt> == NULL). The GMT module will
then allocate space to hold the output and let the API know where this
memory resides. You can then use <a class="reference internal" href="#gmt-retrieve-data">GMT_Retrieve_Data</a> to get a pointer
to the container where the data set was stored. This function requires
fewer arguments since you simply pass the unique ID number of the
resource. The function is described as follows:</p>
<blockquote id="gmt-retrieve-data">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="nf">GMT_Retrieve_Data</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ID</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>The <tt class="docutils literal"><span class="pre">ID</span></tt> is the unique object ID you received when registering the
NULL resource earlier, Since this container has already been created, a
pointer to the object is returned. If there are errors we simply return
NULL and report the error.</p>
</div>
</div>
<div class="section" id="importing-a-data-record">
<h3>3.6.3. Importing a data record<a class="headerlink" href="#importing-a-data-record" title="Permalink to this headline">¶</a></h3>
<p>If your program will read data table records one-by-one you must first
enable this input mechanism with <a class="reference internal" href="#gmt-begin-io">GMT_Begin_IO</a> and then read the
records in a loop using</p>
<blockquote id="gmt-get-record">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="nf">GMT_Get_Record</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">nfields</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where the returned value is either a pointer to a double array with the
current row values or to a character string with the current row,
depending on <tt class="docutils literal"><span class="pre">mode</span></tt>. In either case these pointers point to memory
internal to GMT and should be considered read-only. When we reach
end-of-file, encounter conversion problems, read header comments, or
identify segment headers we return a NULL pointer. The <tt class="docutils literal"><span class="pre">nfields</span></tt>
pointer will return the number of fields returned; pass NULL if your
program should ignore this information.</p>
<p>Normally (<tt class="docutils literal"><span class="pre">mode</span></tt> == <tt class="docutils literal"><span class="pre">GMT_READ_DOUBLE</span></tt>), we return a pointer to
the double array. To read text records, supply instead <tt class="docutils literal"><span class="pre">mode</span></tt> ==
<tt class="docutils literal"><span class="pre">GMT_READ_TEXT</span></tt> and we instead return a pointer to the text
record. However, if you have input records that mixes organized
floating-point columns with text items you could pass <tt class="docutils literal"><span class="pre">mode</span></tt> ==
<tt class="docutils literal"><span class="pre">GMT_READ_MIXED</span></tt>. Then, GMT will attempt to extract the
floating-point values; you can still access the record string, as
discussed below. Finally, if your application needs to be notified when
GMT closes one file and opens the next, add <tt class="docutils literal"><span class="pre">GMT_FILE_BREAK</span></tt> to
<tt class="docutils literal"><span class="pre">mode</span></tt> and check for the status code <tt class="docutils literal"><span class="pre">GMT_IO_NEXT_FILE</span></tt> (by default,
we treat the concatenation of many input files as a single virtual
file). Using <a class="reference internal" href="#gmt-get-record">GMT_Get_Record</a> requires you to first initialize the
source(s) with <a class="reference internal" href="#gmt-init-io">GMT_Init_IO</a>. For certain records, <a class="reference internal" href="#gmt-get-record">GMT_Get_Record</a>
will return NULL and sets status codes that your program will need to
examine to take appropriate response. Table [tbl:iostatus] list the
various status codes you can check for, using <tt class="docutils literal"><span class="pre">GMT_Status_IO</span></tt> (see
next section).</p>
</div>
<div class="section" id="examining-record-status">
<h3>3.6.4. Examining record status<a class="headerlink" href="#examining-record-status" title="Permalink to this headline">¶</a></h3>
<p>Programs that read record-by-record must be aware of what the current
record represents. Given the presence of headers, data gaps, NaN-record,
etc., the developer will want to check the status after reading the next
record. The internal i/o status mode can be interrogated with the function</p>
<blockquote id="gmt-status-io">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Status_IO</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which returns 0 (false) or 1 (true) if the current status is reflected
by the specified <tt class="docutils literal"><span class="pre">mode</span></tt>. There are 11 different modes available to
programmers; for a list see Table <a class="reference internal" href="#tbl-iostatus"><em>IO-status</em></a> For an example of how
these may be used, see the test program <tt class="docutils literal"><span class="pre">testgmtio.c</span></tt>. Developers who plan to import
data on a record-by-record basis may also consult the source code of,
say, <tt class="docutils literal"><span class="pre">blockmean.c</span></tt> or <tt class="docutils literal"><span class="pre">pstext.c</span></tt>, to see examples of working code.</p>
<table border="1" class="docutils" id="tbl-iostatus">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">mode</th>
<th class="head">description and return value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GMT_IO_DATA_RECORD</td>
<td>1 if we read a data record</td>
</tr>
<tr class="row-odd"><td>GMT_IO_TABLE_HEADER</td>
<td>1 if we read a table header</td>
</tr>
<tr class="row-even"><td>GMT_IO_SEGMENT_HEADER</td>
<td>1 if we read a segment header</td>
</tr>
<tr class="row-odd"><td>GMT_IO_ANY_HEADER</td>
<td>1 if we read either header record</td>
</tr>
<tr class="row-even"><td>GMT_IO_MISMATCH</td>
<td>1 if we read incorrect number of columns</td>
</tr>
<tr class="row-odd"><td>GMT_IO_EOF</td>
<td>1 if we reached the end of the file (EOF)</td>
</tr>
<tr class="row-even"><td>GMT_IO_NAN</td>
<td>1 if we only read NaNs</td>
</tr>
<tr class="row-odd"><td>GMT_IO_GAP</td>
<td>1 if this record implies a data gap</td>
</tr>
<tr class="row-even"><td>GMT_IO_NEW_SEGMENT</td>
<td>1 if we enter a new segment</td>
</tr>
<tr class="row-odd"><td>GMT_IO_LINE_BREAK</td>
<td>1 if we encountered a segment header, EOF, NaNs or gap</td>
</tr>
<tr class="row-even"><td>GMT_IO_NEXT_FILE</td>
<td>1 if we finished one file but not the last</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="importing-a-grid-row">
<h3>3.6.5. Importing a grid row<a class="headerlink" href="#importing-a-grid-row" title="Permalink to this headline">¶</a></h3>
<p>If your program must read a grid file row-by-row you must first enable
row-by-row reading with <a class="reference internal" href="#gmt-read-data"><em>GMT_Read_Data</em></a> and then use the
<tt class="docutils literal"><span class="pre">GMT_Get_Row</span></tt> function in a loop; the prototype is</p>
<blockquote id="gmt-get-row">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Get_Row</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">int</span> <span class="n">row_no</span><span class="p">,</span> <span class="k">struct</span> <span class="n">GMT_GRID</span> <span class="o">*</span><span class="n">G</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">row</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">row</span></tt> is a pointer to a single-precision array to receive the
current row, <tt class="docutils literal"><span class="pre">G</span></tt> is the grid in question, and <tt class="docutils literal"><span class="pre">row_no</span></tt> is the number
of the current row to be read. Note this value is only considered if the
row-by-row mode was initialized with <tt class="docutils literal"><span class="pre">GMT_GRID_ROW_BY_ROW_MANUAL</span></tt>.
The user must allocate enough space to hold the entire row in memory.</p>
</div>
<div class="section" id="disable-data-import">
<h3>3.6.6. Disable Data Import<a class="headerlink" href="#disable-data-import" title="Permalink to this headline">¶</a></h3>
<p>Once the record-by-record input processing has completed we disable
further input to prevent accidental reading from occurring (due to poor
program structure, bugs, etc.). We do so by calling <tt class="docutils literal"><span class="pre">GMT_End_IO</span></tt>. This
function disables further record-by-record data import; its prototype is</p>
<blockquote id="gmt-end-io">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_End_IO</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">direction</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>and we specify <tt class="docutils literal"><span class="pre">direction</span></tt> = <tt class="docutils literal"><span class="pre">GMT_IN</span></tt>. At the moment, <tt class="docutils literal"><span class="pre">mode</span></tt> is not
used. This call will also reallocate any arrays obtained into their
proper lengths. The function returns 1 if there is an error
(which is passed back with <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>), otherwise it returns 0.</p>
</div>
</div>
<div class="section" id="manipulate-data">
<span id="sec-manipulate"></span><h2>3.7. Manipulate data<a class="headerlink" href="#manipulate-data" title="Permalink to this headline">¶</a></h2>
<p>Once you have created and allocated empty resources, or read in
resources from the outside, you will wish to manipulate their contents.
This section discusses how to set up loops and access the important
variables for the various data families. For grids and images it may
be required to know what the coordinates are at each node point. This
can be obtained via arrays of coordinates for each dimension, obtained by</p>
<blockquote id="gmt-get-coord">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">double</span> <span class="o">*</span><span class="nf">GMT_Get_Coord</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">family</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dim</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <a class="reference internal" href="#tbl-family"><em>family</em></a> must be <tt class="docutils literal"><span class="pre">GMT_IS_GRID</span></tt> or <tt class="docutils literal"><span class="pre">GMT_IS_DATASET</span></tt>, <tt class="docutils literal"><span class="pre">dim</span></tt> is either
<tt class="docutils literal"><span class="pre">GMT_IS_X</span></tt> or <tt class="docutils literal"><span class="pre">GMT_IS_Y</span></tt>, and <tt class="docutils literal"><span class="pre">data</span></tt> is the grid or image pointer.  This
function will be used below in our example on grid manipulation.</p>
<p>Another aspect of dealing with grids and images is to convert a row and column
2-D reference to our 1-D array index.  Because of grid and image boundary padding
the relationship is not straightforward, hence we supply</p>
<blockquote id="gmt-get-index">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int64_t</span> <span class="nf">GMT_Get_Index</span> <span class="p">(</span><span class="k">struct</span> <span class="n">GMT_GRID_HEADER</span> <span class="o">*</span><span class="n">header</span><span class="p">,</span> <span class="kt">int</span> <span class="n">row</span><span class="p">,</span> <span class="kt">int</span> <span class="n">col</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where the <tt class="docutils literal"><span class="pre">header</span></tt> is the header of either a grid or image, and <tt class="docutils literal"><span class="pre">row</span></tt> and
<tt class="docutils literal"><span class="pre">col</span></tt> is the 2-D position in the grid or image.  We return the 1-D array
position; again this function is used below in our example.</p>
<div class="section" id="manipulate-grids">
<h3>3.7.1. Manipulate grids<a class="headerlink" href="#manipulate-grids" title="Permalink to this headline">¶</a></h3>
<p>Most applications wishing to manipulate grids will want to loop over all
the nodes, typically in a manner organized by rows and columns. In doing
so, the coordinates at each node may also be required for a calculation.
Below is a snippet of code that shows how to do visit all nodes in a
grid and assign each node the product x * y:</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">node</span><span class="p">;</span>
<span class="kt">double</span> <span class="o">*</span><span class="n">x_coord</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">*</span><span class="n">y_coord</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="o">&lt;</span> <span class="p">...</span> <span class="n">create</span> <span class="n">a</span> <span class="n">grid</span> <span class="n">G</span> <span class="n">or</span> <span class="n">read</span> <span class="n">one</span> <span class="p">...</span> <span class="o">&gt;</span>
<span class="n">x_coord</span> <span class="o">=</span> <span class="n">GMT_Get_Coord</span> <span class="p">(</span><span class="n">API</span><span class="p">,</span> <span class="n">GMT_IS_GRID</span><span class="p">,</span> <span class="n">GMT_X</span><span class="p">,</span> <span class="n">G</span><span class="p">);</span>
<span class="n">y_coord</span> <span class="o">=</span> <span class="n">GMT_Get_Coord</span> <span class="p">(</span><span class="n">API</span><span class="p">,</span> <span class="n">GMT_IS_GRID</span><span class="p">,</span> <span class="n">GMT_Y</span><span class="p">,</span> <span class="n">G</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">G</span><span class="o">-&gt;</span><span class="n">header</span><span class="o">-&gt;</span><span class="n">ny</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="n">G</span><span class="o">-&gt;</span><span class="n">header</span><span class="o">-&gt;</span><span class="n">nx</span><span class="p">;</span> <span class="n">col</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">GMT_Get_Index</span> <span class="p">(</span><span class="n">G</span><span class="o">-&gt;</span><span class="n">header</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">);</span>
        <span class="n">G</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_coord</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">*</span> <span class="n">y_coord</span><span class="p">[</span><span class="n">row</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Note the use of <a class="reference internal" href="#gmt-get-index"><em>GMT_Get_Index</em></a> to get the grid node number associated
with the <tt class="docutils literal"><span class="pre">row</span></tt> and <tt class="docutils literal"><span class="pre">col</span></tt> we are visiting. Because GMT grids have
padding (for boundary conditions) the relationship between rows,
columns, and node indices is more complicated and hence we hide that
complexity in <a class="reference internal" href="#gmt-get-index"><em>GMT_Get_Index</em></a>. Note that for trivial procedures such
setting all grid nodes to a constant (e.g., -9999.0) where the row and
column does not enter you can instead do a single loop:</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="n">node</span><span class="p">;</span>
<span class="o">&lt;</span> <span class="p">...</span> <span class="n">create</span> <span class="n">a</span> <span class="n">grid</span> <span class="n">G</span> <span class="n">or</span> <span class="n">read</span> <span class="n">one</span> <span class="p">...</span> <span class="o">&gt;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">node</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">node</span> <span class="o">&lt;</span> <span class="n">G</span><span class="o">-&gt;</span><span class="n">header</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">)</span> <span class="n">G</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.0</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>Note we must use <tt class="docutils literal"><span class="pre">G-&gt;header-&gt;size</span></tt> (size of allocated array) and not
<tt class="docutils literal"><span class="pre">G-&gt;header-&gt;nm</span></tt> (number of nodes in grid) since the latter is smaller
due to the padding and a single loop like the above treats the pad as
part of the &#8220;inside&#8221; grid.</p>
</div>
<div class="section" id="manipulate-data-tables">
<h3>3.7.2. Manipulate data tables<a class="headerlink" href="#manipulate-data-tables" title="Permalink to this headline">¶</a></h3>
<p>Another common application is to process the records in a data table.
Because GMT consider the <tt class="docutils literal"><span class="pre">GMT_DATASET</span></tt> resources to contain one or more
tables, each of which may contain one or more segments, all of which may
contain one or more columns, you will need to have multiple loops to
visit all entries. The following code snippet will visit all data
records and add 1 to all columns beyond the first two (x and y):</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">uint64_t</span> <span class="n">tbl</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">GMT_DATATABLE</span> <span class="o">*</span><span class="n">T</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">GMT_DATASEGMENT</span> <span class="o">*</span><span class="n">S</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

<span class="o">&lt;</span> <span class="p">...</span> <span class="n">create</span> <span class="n">a</span> <span class="n">dataset</span> <span class="n">D</span> <span class="n">or</span> <span class="n">read</span> <span class="n">one</span> <span class="p">...</span> <span class="o">&gt;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">tbl</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">tbl</span> <span class="o">&lt;</span> <span class="n">D</span><span class="o">-&gt;</span><span class="n">n_tables</span><span class="p">;</span> <span class="n">tbl</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>       <span class="cm">/* For each table */</span>
  <span class="n">T</span> <span class="o">=</span> <span class="n">D</span><span class="o">-&gt;</span><span class="n">table</span><span class="p">[</span><span class="n">tbl</span><span class="p">];</span>       <span class="cm">/* Convenient shorthand for current table */</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">seg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">seg</span> <span class="o">&lt;</span> <span class="n">T</span><span class="o">-&gt;</span><span class="n">n_segments</span><span class="p">;</span> <span class="n">seg</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>   <span class="cm">/* For all segments */</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">T</span><span class="o">-&gt;</span><span class="n">segment</span><span class="p">[</span><span class="n">seg</span><span class="p">];</span>   <span class="cm">/* Convenient shorthand for current segment */</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">n_rows</span><span class="p">;</span> <span class="n">row</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">col</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="n">T</span><span class="o">-&gt;</span><span class="n">n_columns</span><span class="p">;</span> <span class="n">col</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">S</span><span class="o">-&gt;</span><span class="n">coord</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">row</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="manipulate-text-tables">
<h3>3.7.3. Manipulate text tables<a class="headerlink" href="#manipulate-text-tables" title="Permalink to this headline">¶</a></h3>
<p>When data file contain text mixed in with numbers you must open the file
as a <tt class="docutils literal"><span class="pre">GMT_TEXTSET</span></tt> and do your own parsing of the data records. The
following code snippet will visit all text records and print them out:</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">uint64_t</span> <span class="n">tbl</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">GMT_TEXTTABLE</span> <span class="o">*</span><span class="n">T</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">GMT_TEXTSEGMENT</span> <span class="o">*</span><span class="n">S</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

<span class="o">&lt;</span> <span class="p">...</span> <span class="n">create</span> <span class="n">a</span> <span class="n">textset</span> <span class="n">D</span> <span class="n">or</span> <span class="n">read</span> <span class="n">one</span> <span class="p">...</span> <span class="o">&gt;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">tbl</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">tbl</span> <span class="o">&lt;</span> <span class="n">D</span><span class="o">-&gt;</span><span class="n">n_tables</span><span class="p">;</span> <span class="n">tbl</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>   <span class="cm">/* For each table */</span>
  <span class="n">T</span> <span class="o">=</span> <span class="n">D</span><span class="o">-&gt;</span><span class="n">table</span><span class="p">[</span><span class="n">tbl</span><span class="p">];</span>        <span class="cm">/* Convenient shorthand for current table */</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">seg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">seg</span> <span class="o">&lt;</span> <span class="n">T</span><span class="o">-&gt;</span><span class="n">n_segments</span><span class="p">;</span> <span class="n">seg</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>   <span class="cm">/* For all segments */</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">T</span><span class="o">-&gt;</span><span class="n">segment</span><span class="p">[</span><span class="n">seg</span><span class="p">];</span>    <span class="cm">/* Convenient shorthand for current segment */</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">n_rows</span><span class="p">;</span> <span class="n">row</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span> <span class="p">(</span><span class="s">&quot;T=%d S=%d R=%d : %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">tbl</span><span class="p">,</span> <span class="n">seg</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">record</span><span class="p">[</span><span class="n">row</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="message-and-verbose-reporting">
<h2>3.8. Message and Verbose Reporting<a class="headerlink" href="#message-and-verbose-reporting" title="Permalink to this headline">¶</a></h2>
<p>The API provides two functions for your program to present information
to the user during the run of the program. One is used for messages that
are always written while the other is used for reports that must exceed
the verbosity settings specified via <strong>-V</strong>.</p>
<blockquote id="gmt-report">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Report</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">level</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">message</span><span class="p">,</span> <span class="p">...);</span>
</pre></div>
</div>
</div></blockquote>
<p>This function takes a verbosity level and a multi-part message (e.g., a
format statement and zero or more variables). The verbosity <tt class="docutils literal"><span class="pre">level</span></tt> is
an integer in the 0–5 range; these are listed in Table [tbl:verbosity].
You assign an appropriate verbosity level to your message, and depending
on the chosen run-time verbosity level set via <strong>-V</strong> your message may
or may not be reported. Only messages whose stated verbosity level is
lower or equal to the <strong>-V</strong><em>level</em> will be printed.</p>
<table border="1" class="docutils" id="tbl-verbosity">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">constant</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GMT_MSG_QUIET</td>
<td>No messages whatsoever</td>
</tr>
<tr class="row-odd"><td>GMT_MSG_NORMAL</td>
<td>Default output, e.g., warnings and errors only</td>
</tr>
<tr class="row-even"><td>GMT_MSG_COMPAT</td>
<td>Compatibility warnings</td>
</tr>
<tr class="row-odd"><td>GMT_MSG_VERBOSE</td>
<td>Verbose level</td>
</tr>
<tr class="row-even"><td>GMT_MSG_LONG_VERBOSE</td>
<td>Longer verbose</td>
</tr>
<tr class="row-odd"><td>GMT_MSG_DEBUG</td>
<td>Debug messages for developers mostly</td>
</tr>
</tbody>
</table>
<blockquote id="gmt-message">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Message</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">format</span><span class="p">,</span> <span class="p">...);</span>
</pre></div>
</div>
</div></blockquote>
<p>This function always prints its message to the standard output. Use the
<tt class="docutils literal"><span class="pre">mode</span></tt> value to control if a time stamp should preface the message.
and if selected how the time information should be formatted. See
Table <a class="reference internal" href="#tbl-timemodes"><em>timemodes</em></a> for the various modes.</p>
<table border="1" class="docutils" id="tbl-timemodes">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">constant</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GMT_TIME_NONE</td>
<td>Display no time information</td>
</tr>
<tr class="row-odd"><td>GMT_TIME_CLOCK</td>
<td>Display current local time</td>
</tr>
<tr class="row-even"><td>GMT_TIME_ELAPSED</td>
<td>Display elapsed time since last reset</td>
</tr>
<tr class="row-odd"><td>GMT_TIME_RESET</td>
<td>Reset the elapsed time to 0</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="presenting-and-accessing-gmt-options">
<span id="sec-parsopt"></span><h2>3.9. Presenting and accessing GMT options<a class="headerlink" href="#presenting-and-accessing-gmt-options" title="Permalink to this headline">¶</a></h2>
<p>As you develop a program you may need to rely on some of
the GMT common options. For instance, you may wish to have your
program present the <tt class="docutils literal"><span class="pre">-R</span></tt> option to the user, let GMT handle the
parsing, and examine the values. You may also wish to encode your own
custom options that may require you to parse user text into the
corresponding floating point dimensions, constants, coordinates, time, etc.
The API provides several functions to simplify these tedious parsing
tasks. This section is intended to show how the programmer will obtain
information from the user that is necessary to do the task at hand
(e.g., special options to provide values and settings for the program).
In the following section we will concern ourselves with preparing
arguments for calling any of the GMT modules.</p>
<div class="section" id="display-usage-syntax-for-gmt-common-options">
<h3>3.9.1. Display usage syntax for GMT common options<a class="headerlink" href="#display-usage-syntax-for-gmt-common-options" title="Permalink to this headline">¶</a></h3>
<p>You can have your program menu display the standard usage message for a
GMT common option by calling the function</p>
<blockquote id="gmt-option">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Option</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">options</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">options</span></tt> is a comma-separated list of GMT common options
(e.g., &#8220;R,J,O,X&#8221;). You can repeat this function with different sets of
options in order to intersperse your own custom options with in an
overall alphabetical order; see any GMT module for examples of typical
layouts.</p>
</div>
<div class="section" id="parsing-the-gmt-common-options">
<h3>3.9.2. Parsing the GMT common options<a class="headerlink" href="#parsing-the-gmt-common-options" title="Permalink to this headline">¶</a></h3>
<p>The parsing of all GMT common option is done by</p>
<blockquote id="gmt-parse-common">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Parse_Common</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="n">list</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">args</span></tt> is a string of the common GMT options your program may
use. An error will be reported if any of the common GMT options fail
to parse, and if so we return TRUE; if not errors we return FALSE. All
other options, including file names, will be silently ignored. The
parsing will update the internal GMT information structure that
affects program operations.</p>
</div>
<div class="section" id="inquiring-about-the-gmt-common-options">
<h3>3.9.3. Inquiring about the GMT common options<a class="headerlink" href="#inquiring-about-the-gmt-common-options" title="Permalink to this headline">¶</a></h3>
<p>The API provide only a limited window into the full GMT machinery
accessible to the modules. You can determine if a particular common
option has been parsed and in some cases determine the values that was set with</p>
<blockquote id="gmt-get-common">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Get_Common</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">option</span><span class="p">,</span> <span class="kt">double</span> <span class="o">*</span><span class="n">par</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">option</span></tt> is a single option character (e.g., &#8216;R&#8217;) and <tt class="docutils literal"><span class="pre">par</span></tt> is
a double array with at least a length of 6. If the particular option has
been parsed then the function returns the number of parameters passed
back via <tt class="docutils literal"><span class="pre">par</span></tt>; otherwise we return -1. For instance, to determine if
the <tt class="docutils literal"><span class="pre">-R</span></tt> was set and what the resulting region was set to you may call</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="n">GMT_Get_Common</span> <span class="p">(</span><span class="n">API</span><span class="p">,</span> <span class="sc">&#39;R&#39;</span><span class="p">,</span> <span class="n">wesn</span><span class="p">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* wesn now contains the boundary information */</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>The <tt class="docutils literal"><span class="pre">wesn</span></tt> array could now be passed to the various read and create
functions for GMT resources.</p>
</div>
<div class="section" id="parsing-text-values">
<h3>3.9.4. Parsing text values<a class="headerlink" href="#parsing-text-values" title="Permalink to this headline">¶</a></h3>
<p>Your program may need to request values from the user, such as
distances, plot dimensions, coordinates, and other data. The conversion
from such text to actual distances, taking units into account, is
tedious to program. You can simplify this by using</p>
<blockquote id="gmt-get-value">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Get_Value</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="kt">double</span> <span class="n">par</span><span class="p">[]);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">arg</span></tt> is the text item with one or more values that are
separated by commas, spaces, tabs, semi-colons, or slashes, and <tt class="docutils literal"><span class="pre">par</span></tt> is an array long
enough to hold all the items you are parsing. The function returns the
number of items parsed, or -1 if there is an error. For instance, assume
the character string <tt class="docutils literal"><span class="pre">origin</span></tt> was given by the user as two geographic
coordinates separated by a slash (e.g., <tt class="docutils literal"><span class="pre">&quot;35:45W/19:30:55.3S&quot;</span></tt>). We
obtain the two coordinates as decimal degrees by calling</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="n">n</span> <span class="o">=</span> <span class="n">GMT_Get_Value</span> <span class="p">(</span><span class="n">API</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">pair</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>Your program can now check that <tt class="docutils literal"><span class="pre">n</span></tt> equals 2 and then use the values
in <tt class="docutils literal"><span class="pre">pairs</span></tt>. Note: Dimensions given with units of inches, cm, or points
are converted to the GMT default length unit (<a class="reference internal" href="gmt.conf.html#proj-length-unit"><em>PROJ_LENGTH_UNIT</em></a>)
[cm], while distances given in km, nautical miles, miles, feet, or
survey feet are returned in meters. Arc lengths in minutes and seconds
are returned in decimal degrees, and date/time values are returned in
seconds since the epoch (1970).</p>
</div>
<div class="section" id="inquiring-about-a-gmt-default-parameter">
<h3>3.9.5. Inquiring about a GMT default parameter<a class="headerlink" href="#inquiring-about-a-gmt-default-parameter" title="Permalink to this headline">¶</a></h3>
<p>If your program needs to determine one or more of the current
GMT default settings you can do so via</p>
<blockquote id="gmt-get-default">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Get_Default</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">keyword</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">keyword</span></tt> is one such keyword (e.g., <a class="reference internal" href="gmt.conf.html#proj-length-unit"><em>PROJ_LENGTH_UNIT</em></a>) and
<tt class="docutils literal"><span class="pre">value</span></tt> must be a character array long enough to hold the answer.
Depending on what parameter you selected you could further convert it to
a numerical value with <tt class="docutils literal"><span class="pre">GMT_Get_Value</span></tt> or just use it in a text comparison.</p>
</div>
</div>
<div class="section" id="prepare-module-options">
<span id="sec-func"></span><h2>3.10. Prepare module options<a class="headerlink" href="#prepare-module-options" title="Permalink to this headline">¶</a></h2>
<p>One of the advantages of programming with the API is that you
have access to the high-level GMT modules. For example, if your
program must compute the distance from a point to all other points on
the node you can simply set up options and call <tt class="docutils literal"><span class="pre">GMT_grdmath</span></tt> to do it
for you and accept the result back as an input grid. All the module
interfaces are identical are looks like</p>
<blockquote id="gmt-call-module">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Call_Module</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">module</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">args</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>Here, <tt class="docutils literal"><span class="pre">module</span></tt> can be any of the GMT modules, such as
<tt class="docutils literal"><span class="pre">psxy</span></tt> or <tt class="docutils literal"><span class="pre">grdvolume</span></tt>.  All GMT modules may be called with one of
three sets of <tt class="docutils literal"><span class="pre">args</span></tt> depending on <tt class="docutils literal"><span class="pre">mode</span></tt>. The three modes differ in
how the options are passed to the module:</p>
<blockquote>
<div><dl class="docutils">
<dt><em>mode</em> == <tt class="docutils literal"><span class="pre">GMT_MODULE_EXIST</span></tt></dt>
<dd>Return GMT_NOERROR (0) if module exists, GMT_NOT_A_VALID_MODULE otherwise.</dd>
<dt><em>mode</em> == <tt class="docutils literal"><span class="pre">GMT_MODULE_PURPOSE</span></tt></dt>
<dd>Just prints the purpose of the module; args should be NULL.</dd>
<dt><em>mode</em> == <tt class="docutils literal"><span class="pre">GMT_MODULE_OPT</span></tt></dt>
<dd>Expects <tt class="docutils literal"><span class="pre">args</span></tt> to be a pointer to a doubly-linked list of objects with individual
options for the current program. We will see
how API functions can help prepare such lists.</dd>
<dt><em>mode</em> == <tt class="docutils literal"><span class="pre">GMT_MODULE_CMD</span></tt></dt>
<dd>Expects <tt class="docutils literal"><span class="pre">args</span></tt> to be a single text string with all required options.</dd>
<dt><em>mode &gt; 0</em></dt>
<dd>Expects <tt class="docutils literal"><span class="pre">args</span></tt> to be an array of text options and <tt class="docutils literal"><span class="pre">mode</span></tt> to be a count of how many
options are passed (i.e., the <tt class="docutils literal"><span class="pre">argc,</span> <span class="pre">argv[]</span></tt> model used by the GMT programs themselves).</dd>
</dl>
</div></blockquote>
<p>If <tt class="docutils literal"><span class="pre">module</span></tt> equals NULL and <tt class="docutils literal"><span class="pre">mode</span> <span class="pre">==</span> <span class="pre">GMT_MODULE_PURPOSE</span></tt> then we list summaries for all the modules
If no module by the given name is found we return -1.</p>
<div class="section" id="set-program-options-via-text-array-arguments">
<h3>3.10.1. Set program options via text array arguments<a class="headerlink" href="#set-program-options-via-text-array-arguments" title="Permalink to this headline">¶</a></h3>
<p>When <tt class="docutils literal"><span class="pre">mode</span> <span class="pre">&gt;</span> <span class="pre">0</span></tt> we expect an array <tt class="docutils literal"><span class="pre">args</span></tt> of character
strings that each holds a single command line options (e.g.,
&#8220;-R120:30/134:45/8S/3N&#8221;) and interpret <tt class="docutils literal"><span class="pre">mode</span></tt> to be the count of how
many options are passed. This, of course, is almost exactly how the
stand-alone GMT programs are called (and reflects how they themselves
are activated internally). We call this the &#8220;argc-argv&#8221; mode. Depending
on how your program obtains the necessary options you may find that this
interface offers all you need.</p>
</div>
<div class="section" id="set-program-options-via-text-command">
<h3>3.10.2. Set program options via text command<a class="headerlink" href="#set-program-options-via-text-command" title="Permalink to this headline">¶</a></h3>
<p>If <tt class="docutils literal"><span class="pre">mode</span> <span class="pre">==</span></tt> 0 then <tt class="docutils literal"><span class="pre">args</span></tt> will be examined to see if it contains
several options within a single command string. If so we will break
these into separate options. This is useful if you wish to pass a single
string such as &#8220;-R120:30/134:45/8S/3N -JM6i mydata.txt -Sc0.2c&#8221;. We call
this the &#8220;command&#8221; mode.</p>
</div>
<div class="section" id="set-program-options-via-linked-structures">
<h3>3.10.3. Set program options via linked structures<a class="headerlink" href="#set-program-options-via-linked-structures" title="Permalink to this headline">¶</a></h3>
<p>The third, linked-list interface allows developers using higher-level
programming languages to pass all command options via a pointer to a
NULL-terminated, doubly-linked list of option structures, each
containing information about a single option. Here, instead of text
arguments we pass the pointer to the linked list of options mentioned
above, and <tt class="docutils literal"><span class="pre">mode</span></tt> must be passed as -1 (or any negative value). Using
this interface can be more involved since you need to generate the
linked list of program options; however, utility functions exist to
simplify its use. This interface is intended for programs whose internal
workings are better suited to generate such arguments &#8211; we call this the
&#8220;options&#8221; mode. The order in the list is not important as GMT will
sort it internally according to need. The option structure is defined below.</p>
<blockquote id="options">
<div><div class="highlight-c"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="p">{</span>
    <span class="kt">char</span>               <span class="n">option</span><span class="p">;</span>  <span class="cm">/* Single character of the option (e.g., &#39;G&#39; for -G) */</span>
    <span class="kt">char</span>              <span class="o">*</span><span class="n">arg</span><span class="p">;</span>     <span class="cm">/* String pointer with arguments (NULL if not used) */</span>
    <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>    <span class="cm">/* Pointer to next option (NULL for last option) */</span>
    <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="n">prev</span><span class="p">;</span>    <span class="cm">/* Pointer to previous option (NULL for first option) */</span>
<span class="p">};</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="convert-between-text-and-linked-structures">
<h3>3.10.4. Convert between text and linked structures<a class="headerlink" href="#convert-between-text-and-linked-structures" title="Permalink to this headline">¶</a></h3>
<p>To assist programmers there are also two convenience functions that
allow you to convert between the two argument formats. They are</p>
<blockquote id="gmt-create-options">
<div><div class="highlight-c"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="nf">GMT_Create_Options</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">args</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>This function accepts your array of text arguments (cast via a void
pointer), allocates the necessary space, performs the conversion, and
returns a pointer to the head of the linked list of program options.
However, in case of an error we return a NULL pointer and set
<tt class="docutils literal"><span class="pre">API-&gt;error</span></tt> to indicate the nature of the problem. Otherwise, the
pointer may now be passed to the relevant <tt class="docutils literal"><span class="pre">GMT_module</span></tt>. Note that if
your list of text arguments were obtained from a C <tt class="docutils literal"><span class="pre">main()</span></tt> function
then <tt class="docutils literal"><span class="pre">argv[0]</span></tt> will contain the name of the calling program. To avoid
passing this as a file name option, call <a class="reference internal" href="#gmt-create-options">GMT_Create_Options</a> with
<tt class="docutils literal"><span class="pre">argc-1</span></tt> and <tt class="docutils literal"><span class="pre">argv+1</span></tt>. If you wish to pass a single text string with
multiple options (in lieu of an array of text strings), then pass
<tt class="docutils literal"><span class="pre">argc</span></tt> = 0. When no longer needed you can remove the entire list by calling</p>
<blockquote id="gmt-destroy-options">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Destroy_Options</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">**</span><span class="n">list</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>The function returns 1 if there is an error (which is passed back
with <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>), otherwise it returns 0.</p>
<p>The inverse function prototype is</p>
<blockquote id="gmt-create-args">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">char</span> <span class="o">**</span><span class="nf">GMT_Create_Args</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">argc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="n">list</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which allocates space for the text strings and performs the conversion;
it passes back the count of the arguments via <tt class="docutils literal"><span class="pre">argc</span></tt> and returns a
pointer to the text array. In the case of an error we return a NULL
pointer and set <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt> to reflect the error type. Note that
<tt class="docutils literal"><span class="pre">argv[0]</span></tt> will not contain the name of the program as is the case the
arguments presented by a C <tt class="docutils literal"><span class="pre">main()</span></tt> function. When you no longer have
any use for the text array, call</p>
<blockquote id="gmt-destroy-args">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Destroy_Args</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">[]);</span>
</pre></div>
</div>
</div></blockquote>
<p>to deallocate the space used. This function returns 1 if there is
an error (which is passed back with <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>), otherwise it returns 0.</p>
<p>Finally, to convert the linked list of option structures to a single
text string command, use</p>
<blockquote id="gmt-create-cmd">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">char</span> <span class="o">*</span><span class="nf">GMT_Create_Cmd</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="n">list</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>Developers who plan to import and export GMT shell scripts might find
it convenient to use these functions. In case of an error we return a
NULL pointer and set <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>, otherwise a pointer to an allocated
string is returned.  When you no longer have
any use for the text string, call</p>
<blockquote id="gmt-destroy-cmd">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Destroy_Cmd</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>to deallocate the space used. This function returns 1 if there is
an error (which is passed back with <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>), otherwise it
returns 0.</p>
</div>
<div class="section" id="manage-the-linked-list-of-options">
<h3>3.10.5. Manage the linked list of options<a class="headerlink" href="#manage-the-linked-list-of-options" title="Permalink to this headline">¶</a></h3>
<p>Several additional utility functions are available for programmers who
wish to manipulate program option structures within their own programs.
These allow you to create new option structures, append them to the
linked list, replace existing options with new values, find a particular
option, and remove options from the list. Note: The order in which the
options appear in the linked list is of no consequence to GMT.
Internally, GMT will sort and process the options in the manner
required. Externally, you are free to maintain your own order.</p>
<div class="section" id="make-a-new-option-structure">
<h4>3.10.5.1. Make a new option structure<a class="headerlink" href="#make-a-new-option-structure" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">GMT_Make_Option</span></tt> will allocate a new option structure, assign it
values given the <tt class="docutils literal"><span class="pre">option</span></tt> and <tt class="docutils literal"><span class="pre">arg</span></tt> parameter (pass NULL if there is
no argument for this option), and returns a pointer to the allocated
structure. The prototype is</p>
<blockquote id="gmt-make-option">
<div><div class="highlight-c"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="nf">GMT_Make_Option</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">char</span> <span class="n">option</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">arg</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>Should memory allocation fail the function will print an error message
set an error code via <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>, and return NULL.</p>
</div>
<div class="section" id="append-an-option-to-the-linked-list">
<h4>3.10.5.2. Append an option to the linked list<a class="headerlink" href="#append-an-option-to-the-linked-list" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">GMT_Append_Option</span></tt> will append the specified <tt class="docutils literal"><span class="pre">option</span></tt> to the end of
the doubly-linked <tt class="docutils literal"><span class="pre">list</span></tt>. The prototype is</p>
<blockquote id="gmt-append-option">
<div><div class="highlight-c"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="nf">GMT_Append_Option</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="n">option</span><span class="p">,</span>
                                      <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="n">list</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>We return the list back, and if <tt class="docutils literal"><span class="pre">list</span></tt> is given as NULL we return
<tt class="docutils literal"><span class="pre">option</span></tt> as the start of the new list. Any errors results in a NULL
pointer with <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt> holding the error type.</p>
</div>
<div class="section" id="find-an-option-in-the-linked-list">
<h4>3.10.5.3. Find an option in the linked list<a class="headerlink" href="#find-an-option-in-the-linked-list" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">GMT_Find_Option</span></tt> will return a pointer <tt class="docutils literal"><span class="pre">ptr</span></tt> to the first option in
the linked list starting at <tt class="docutils literal"><span class="pre">list</span></tt> whose option character equals
<tt class="docutils literal"><span class="pre">option</span></tt>. If not found we return NULL. While this is not necessarily
an error we still set <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt> accordingly. The prototype is</p>
<blockquote id="gmt-find-option">
<div><div class="highlight-c"><div class="highlight"><pre><span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="nf">GMT_Find_Option</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">char</span> <span class="n">option</span><span class="p">,</span>
                                    <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="n">list</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>If you need to look for multiple occurrences of a certain option you
will need to call <a class="reference internal" href="#gmt-find-option">GMT_Find_Option</a> again, passing the option
following the previously found option as the <tt class="docutils literal"><span class="pre">list</span></tt> entry, i.e.,</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="n">list</span> <span class="o">=</span> <span class="o">*</span><span class="n">ptr</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="update-an-existing-option-in-the-list">
<h4>3.10.5.4. Update an existing option in the list<a class="headerlink" href="#update-an-existing-option-in-the-list" title="Permalink to this headline">¶</a></h4>
<p><a class="reference internal" href="#gmt-update-option">GMT_Update_Option</a> will replace the argument of <tt class="docutils literal"><span class="pre">current</span></tt> with the
new argument <tt class="docutils literal"><span class="pre">arg</span></tt> and otherwise leave the option at its place in the
list. The prototype is</p>
<blockquote id="gmt-update-option">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Update_Option</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="n">current</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">arg</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>An error will be reported if (a) <tt class="docutils literal"><span class="pre">current</span></tt> is NULL or (b) <tt class="docutils literal"><span class="pre">arg</span></tt> is
NULL. The function returns 1 if there is an error, otherwise it returns 0.</p>
</div>
<div class="section" id="delete-an-existing-option-in-the-linked-list">
<h4>3.10.5.5. Delete an existing option in the linked list<a class="headerlink" href="#delete-an-existing-option-in-the-linked-list" title="Permalink to this headline">¶</a></h4>
<p>You may use <tt class="docutils literal"><span class="pre">GMT_Delete_Option</span></tt> to remove <tt class="docutils literal"><span class="pre">option</span></tt> from the linked
<tt class="docutils literal"><span class="pre">list</span></tt>. The prototype is</p>
<blockquote id="gmt-delete-option">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Delete_Option</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="k">struct</span> <span class="n">GMT_OPTION</span> <span class="o">*</span><span class="n">current</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>We return TRUE if the option is not found in the list and set
<tt class="docutils literal"><span class="pre">API-&gt;error</span></tt> accordingly. Note: Only the first occurrence of the
specified option will be deleted. If you need to delete all such options
you will need to call this function in a loop until it returns a
non-zero status.</p>
</div>
<div class="section" id="specify-a-file-via-an-linked-option">
<h4>3.10.5.6. Specify a file via an linked option<a class="headerlink" href="#specify-a-file-via-an-linked-option" title="Permalink to this headline">¶</a></h4>
<p>To specify an input file name via an option, simply use &lt; as the
option (this is what <a class="reference internal" href="#gmt-create-options">GMT_Create_Options</a> does when it finds filenames
on the command line). Likewise, &gt; can be used to explicitly
indicate an output file. In order to append to an existing file, use
&gt;&gt;. For example the following command would read from file.A and
append to file.B:</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="n">gmtconvert</span> <span class="o">-&lt;</span><span class="n">file</span><span class="p">.</span><span class="n">A</span> <span class="o">-&gt;&gt;</span><span class="n">file</span><span class="p">.</span><span class="n">B</span>
</pre></div>
</div>
</div></blockquote>
<p>These options also work on the command line but usually one would have
to escape the special characters &lt; and &gt; as they are
used for file redirection.</p>
</div>
</div>
</div>
<div class="section" id="calling-a-gmt-module">
<h2>3.11. Calling a GMT module<a class="headerlink" href="#calling-a-gmt-module" title="Permalink to this headline">¶</a></h2>
<p>Given your linked list of program options (or text array) and possibly
some registered resources, you can now call the required GMT module
using one of the two flavors discussed in <a class="reference internal" href="#sec-func"><em>section</em></a> All
modules return an error or status code that your program should consider
before processing the results.</p>
</div>
<div class="section" id="adjusting-headers-and-comments">
<h2>3.12. Adjusting headers and comments<a class="headerlink" href="#adjusting-headers-and-comments" title="Permalink to this headline">¶</a></h2>
<p>All header records in incoming datasets are stored in memory. You may
wish to replace these records with new information, or append new
information to the existing headers. This is achieved with</p>
<blockquote id="gmt-set-comment">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="n">GMT_Set_Comment</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">family</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span>
                     <span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Again, <a class="reference internal" href="#tbl-family"><em>family</em></a> selects which kind of resource is passed via <tt class="docutils literal"><span class="pre">data</span></tt>.
The <tt class="docutils literal"><span class="pre">mode</span></tt> determines what kind of comment is being considered, how it
should be included, and in what form the comment passed via <tt class="docutils literal"><span class="pre">arg</span></tt> is.
Table <a class="reference internal" href="#tbl-comments"><em>comments</em></a> lists the available options, which may be combined
by adding (bitwise &#8220;or&#8221;). The <tt class="docutils literal"><span class="pre">GMT_Set_Comment</span></tt> does not actually
output anything but sets the relevant comment and header records in the
relevant structure. When a file is written out the information will be
output as well (Note: Users can always decide if they wish to turn
header output on or off via the common GMT option <tt class="docutils literal"><span class="pre">-h</span></tt>. For
record-by-record writing you must enable the header block output when
you call <a class="reference internal" href="#gmt-begin-io">GMT_Begin_IO</a></p>
<table border="1" class="docutils" id="tbl-comments">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">constant</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GMT_COMMENT_IS_TEXT</td>
<td>Comment is a text string</td>
</tr>
<tr class="row-odd"><td>GMT_COMMENT_IS_OPTION</td>
<td>Comment is a linked list of GMT_OPTION structures</td>
</tr>
<tr class="row-even"><td>GMT_COMMENT_IS_COMMAND</td>
<td>Comment is the command</td>
</tr>
<tr class="row-odd"><td>GMT_COMMENT_IS_REMARK</td>
<td>Comment is the remark</td>
</tr>
<tr class="row-even"><td>GMT_COMMENT_IS_TITLE</td>
<td>Comment is the title</td>
</tr>
<tr class="row-odd"><td>GMT_COMMENT_IS_NAME_X</td>
<td>Comment is the x variable name (grids only)</td>
</tr>
<tr class="row-even"><td>GMT_COMMENT_IS_NAME_Y</td>
<td>Comment is the y variable name (grids only)</td>
</tr>
<tr class="row-odd"><td>GMT_COMMENT_IS_NAME_Z</td>
<td>Comment is the z variable name (grids only)</td>
</tr>
<tr class="row-even"><td>GMT_COMMENT_IS_COLNAMES</td>
<td>Comment is the column names header</td>
</tr>
<tr class="row-odd"><td>GMT_COMMENT_IS_RESET</td>
<td>Comment replaces existing information</td>
</tr>
</tbody>
</table>
<p>The named modes (<em>command</em>, <em>remark</em>, <em>title</em>, <em>name_x,y,z</em> and
<em>colnames</em> are used to distinguish regular text comments from specific
fields in the header structures of the data resources, such as
<tt class="docutils literal"><span class="pre">GMT_GRID</span></tt>. For the various table resources (e.g., <tt class="docutils literal"><span class="pre">GMT_DATASET</span></tt>)
these modifiers result in a specially formatted comments beginning with
&#8220;Command: &#8221; or &#8220;Remark: &#8221;, reflecting how this type of information is
encoded in the headers.</p>
</div>
<div class="section" id="exporting-data">
<h2>3.13. Exporting Data<a class="headerlink" href="#exporting-data" title="Permalink to this headline">¶</a></h2>
<p>If your program needs to write any of the four recognized data types
(CPT files, data tables, text tables, or GMT grids) you can use the
<a class="reference internal" href="#gmt-put-data">GMT_Put_Data</a>. In the case of data and text tables, you may also
consider the <a class="reference internal" href="#gmt-put-record">GMT_Put_Record</a> function. As a general rule, your
program organization may simplify if you can write and export the entire
resource with <a class="reference internal" href="#gmt-put-data">GMT_Put_Data</a>. However, if the program logic is simple
or already involves using <a class="reference internal" href="#gmt-get-record">GMT_Get_Record</a>, it may be better to export
one data record at the time via <a class="reference internal" href="#gmt-put-record">GMT_Put_Record</a>.</p>
<p>Both of these output functions takes a parameter called <tt class="docutils literal"><span class="pre">mode</span></tt>. The
<tt class="docutils literal"><span class="pre">mode</span></tt> parameter generally takes on different meanings for the
different data types and will be discussed below. However, one bit
setting is common to all types: By default, you are only allowed to
write a data resource once; the resource is then flagged to have been
written and subsequent attempts to write to the same resource will
quietly be ignored. In the unlikely event you need to re-write a
resource you can override this default behavior by adding <tt class="docutils literal"><span class="pre">GMT_IO_RESET</span></tt>
to your <tt class="docutils literal"><span class="pre">mode</span></tt> parameter.</p>
<div class="section" id="enable-data-export">
<h3>3.13.1. Enable Data Export<a class="headerlink" href="#enable-data-export" title="Permalink to this headline">¶</a></h3>
<p>Similar to the data import procedures, once all output destinations have
been registered, we signal the API that we are done with the
registration phase and are ready to start the actual data export. As for
input, this step is only needed when dealing with record-by-record
writing. Again, we enable record-by-record writing by calling
<a class="reference internal" href="#gmt-begin-io">GMT_Begin_IO</a>, this time with <tt class="docutils literal"><span class="pre">direction</span></tt> = <tt class="docutils literal"><span class="pre">GMT_OUT</span></tt>. This function
enables data export and prepares the registered destinations for the
upcoming writing.</p>
</div>
<div class="section" id="exporting-a-data-set">
<h3>3.13.2. Exporting a data set<a class="headerlink" href="#exporting-a-data-set" title="Permalink to this headline">¶</a></h3>
<p>To have your program accept results from GMT modules and write them
separately requires you to use the <a class="reference internal" href="#gmt-write-data">GMT_Write_Data</a> or
<a class="reference internal" href="#gmt-put-data">GMT_Put_Data</a> functions. They are very similar to the
<a class="reference internal" href="#gmt-read-data">GMT_Read_Data</a> and <a class="reference internal" href="#gmt-get-data">GMT_Get_Data</a> functions encountered earlier.</p>
<div class="section" id="exporting-a-data-set-to-a-file-stream-or-handle">
<h4>3.13.2.1. Exporting a data set to a file, stream, or handle<a class="headerlink" href="#exporting-a-data-set-to-a-file-stream-or-handle" title="Permalink to this headline">¶</a></h4>
<p>The prototype for writing to a file (via name, stream, or file handle) is</p>
<blockquote id="gmt-write-data">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Write_Data</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">family</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">method</span><span class="p">,</span>
                    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">geometry</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span>
                    <span class="kt">double</span> <span class="n">wesn</span><span class="p">[],</span> <span class="kt">void</span> <span class="o">*</span><span class="n">output</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><a class="reference internal" href="#gmt-create-session"><em>API</em></a></li>
<li><a class="reference internal" href="#tbl-family"><em>family</em></a></li>
<li><a class="reference internal" href="#tbl-methods"><em>method</em></a></li>
<li><a class="reference internal" href="#tbl-geometry"><em>geometry</em></a></li>
<li>mode &#8211; specific to each data type (<em>see below</em>)</li>
<li><a class="reference internal" href="#tbl-wesn"><em>wesn</em></a></li>
<li>output &#8211;</li>
<li>data &#8211; A pointer to any of the four structures <a class="reference internal" href="#struct-vector"><em>GMT_VECTOR</em></a>,
<a class="reference internal" href="#struct-matrix"><em>GMT_MATRIX</em></a>, <a class="reference internal" href="#struct-grid"><em>GMT_GRID</em></a>, <a class="reference internal" href="#struct-palette"><em>GMT_PALETTE</em></a></li>
<li>Return: 0 on success, otherwise return -1 and set API-&gt;error to reflect to cause.</li>
</ul>
<p>where <tt class="docutils literal"><span class="pre">data</span></tt> is a pointer to any of the four structures discussed previously.</p>
<dl class="docutils">
<dt><strong>CPT table</strong></dt>
<dd><tt class="docutils literal"><span class="pre">mode</span></tt> controls if the CPT table&#8217;s back-, fore-, and NaN-colors
should be written (1) or not (0).</dd>
<dt><strong>Data table</strong></dt>
<dd><p class="first">If <tt class="docutils literal"><span class="pre">method</span></tt> is <tt class="docutils literal"><span class="pre">GMT_IS_FILE</span></tt>, then the value of <tt class="docutils literal"><span class="pre">mode</span></tt> affects
how the data set is written:</p>
<dl class="last docutils">
<dt><strong>GMT_WRITE_SET</strong></dt>
<dd>The entire data set will be written to the single file [0].</dd>
<dt><strong>GMT_WRITE_TABLE</strong></dt>
<dd>Each table in the data set is written to individual files [1].
You can either specify an output file name that <em>must</em> contain
one C-style format specifier for a int variable (e.g.,
&#8220;New_Table_%06d.txt&#8221;), which will be replaced with the table
number (a running number from 0) <em>or</em> you must assign to each
table <em>i</em> a unique output file name via the
<tt class="docutils literal"><span class="pre">D-&gt;table[i]-&gt;file[GMT_OUT]</span></tt> variables prior to calling the
function.</dd>
<dt><strong>GMT_WRITE_SEGMENT</strong></dt>
<dd>Each segment in the data set is written to an individual file
[2]. Same setup as for <tt class="docutils literal"><span class="pre">GMT_WRITE_TABLE</span></tt> except we use
sequential segment numbers to build the file names.</dd>
<dt><strong>GMT_WRITE_TABLE_SEGMENT</strong></dt>
<dd>Each segment in the data set is written to an individual file
[3]. You can either specify an output file name that <em>must</em>
contain two C-style format specifiers for two int variables
(e.g., &#8220;New_Table_%06d_Segment_%03d.txt&#8221;), which will be
replaced with the table and segment numbers, <em>or</em> you must
assign to each segment <em>j</em> in each table <em>i</em> a unique output
file name via the <tt class="docutils literal"><span class="pre">D-&gt;table[i]-&gt;segment[j]-&gt;file[GMT_OUT]</span></tt>
variables prior to calling the function.</dd>
<dt><strong>GMT_WRITE_OGR</strong></dt>
<dd>Writes the dataset in OGR/GMT format in conjunction with the
<tt class="docutils literal"><span class="pre">-a</span></tt> setting [4].</dd>
</dl>
</dd>
<dt><strong>Text table</strong></dt>
<dd>The <tt class="docutils literal"><span class="pre">mode</span></tt> is used the same way as for data tables.</dd>
<dt><strong>GMT grid</strong></dt>
<dd>Here, <tt class="docutils literal"><span class="pre">mode</span></tt> may be <tt class="docutils literal"><span class="pre">GMT_GRID_HEADER_ONLY</span></tt> to only update a
file&#8217;s header structure, but normally it is simply <tt class="docutils literal"><span class="pre">GMT_GRID_ALL</span></tt>
so the entire grid and its header will be exported (a subset is
not allowed during export). However, in the event your data array
holds both the real and imaginary parts of a complex data set you
must add either <tt class="docutils literal"><span class="pre">GMT_GRID_IS_COMPLEX_REAL</span></tt> or
<tt class="docutils literal"><span class="pre">GMT_GRID_IS_COMPLEX_IMAG</span></tt> to <tt class="docutils literal"><span class="pre">mode</span></tt> so as to export the
corresponding grid values correctly. Finally, for native binary
grids you may skip writing the grid header by adding
<tt class="docutils literal"><span class="pre">GMT_GRID_NO_HEADER</span></tt>; this setting is ignored for other grid
formats. If your output grid is huge and you are building it
row-by-row, set <tt class="docutils literal"><span class="pre">mode</span></tt> to <tt class="docutils literal"><span class="pre">GMT_GRID_HEADER_ONLY</span></tt> |
<tt class="docutils literal"><span class="pre">GMT_GRID_ROW_BY_ROW</span></tt>. You can then write the grid row-by-row
using <a class="reference internal" href="#gmt-put-row">GMT_Put_Row</a>. By default the rows will be automatically
processed in order. To completely specify which row to be written,
use <tt class="docutils literal"><span class="pre">GMT_GRID_ROW_BY_ROW_MANUAL</span></tt> instead.</dd>
</dl>
<p>Note: If <tt class="docutils literal"><span class="pre">method</span></tt> is GMT_IS_FILE, <a class="reference internal" href="#tbl-family"><em>family</em></a> is <tt class="docutils literal"><span class="pre">GMT_IS_GRID</span></tt>,
and the filename implies a change from NaN to another value then the grid is
modified accordingly. If you continue to use that grid after writing please be
aware that the changes you specified were applied to the grid.</p>
</div>
<div class="section" id="exporting-a-data-set-to-memory">
<h4>3.13.2.2. Exporting a data set to memory<a class="headerlink" href="#exporting-a-data-set-to-memory" title="Permalink to this headline">¶</a></h4>
<p>If writing to a memory destination you will want to first register that
destination and then use the returned ID with <tt class="docutils literal"><span class="pre">GMT_Put_Data</span></tt> instead:</p>
<blockquote id="gmt-put-data">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Put_Data</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ID</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">ID</span></tt> is the unique ID of the registered destination, <tt class="docutils literal"><span class="pre">mode</span></tt> is
specific to each data type (and controls aspects of the output
structuring), and <tt class="docutils literal"><span class="pre">data</span></tt> is a pointer to any of the four structures
discussed previously. For more detail, see <a class="reference internal" href="#gmt-write-data">GMT_Write_Data</a> above. If
successful the function returns 0; otherwise we return 1
and set <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt> to reflect to cause.</p>
</div>
</div>
<div class="section" id="exporting-a-data-record">
<h3>3.13.3. Exporting a data record<a class="headerlink" href="#exporting-a-data-record" title="Permalink to this headline">¶</a></h3>
<p>If your program must write data table records one-by-one you must first
enable record-by-record writing with <a class="reference internal" href="#gmt-begin-io">GMT_Begin_IO</a> and then use the
<tt class="docutils literal"><span class="pre">GMT_Put_Record</span></tt> function in a loop; the prototype is</p>
<blockquote id="gmt-put-record">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Put_Record</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">rec</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">rec</span></tt> is a pointer to either (a) a double-precision array with
the current row. Then, <tt class="docutils literal"><span class="pre">rec</span></tt> is expected to hold at least as many
items as the current setting of <tt class="docutils literal"><span class="pre">n_col[GMT_OUT]</span></tt>, which represents the
number of columns in the output destination. Alternatively (b), <tt class="docutils literal"><span class="pre">rec</span></tt>
points to a text string. The <tt class="docutils literal"><span class="pre">mode</span></tt> parameter must be set to reflect
what is passed. Using <a class="reference internal" href="#gmt-put-record">GMT_Put_Record</a> requires you to first
initialize the destination with <a class="reference internal" href="#gmt-init-io">GMT_Init_IO</a>. Note that for families
GMT_IS_DATASET and <tt class="docutils literal"><span class="pre">GMT_IS_TEXTSET</span></tt> the methods <tt class="docutils literal"><span class="pre">GMT_IS_DUPLICATE</span></tt> and
GMT_IS_REFERENCE are not supported since you can simply populate the
GMT_DATASET structure directly. As mentioned, <tt class="docutils literal"><span class="pre">mode</span></tt> affects what is
actually written:</p>
<dl class="docutils">
<dt><strong>GMT_WRITE_DOUBLE</strong></dt>
<dd>Normal operation that builds the current output record from the values in <tt class="docutils literal"><span class="pre">rec</span></tt>.</dd>
<dt><strong>GMT_WRITE_TEXT</strong></dt>
<dd>For ASCII output mode we write the text string <tt class="docutils literal"><span class="pre">rec</span></tt>. If <tt class="docutils literal"><span class="pre">rec</span></tt>
is NULL then we use the current (last imported) text record. If
binary output mode we quietly skip writing this record.</dd>
<dt><strong>GMT_WRITE_TABLE_HEADER</strong></dt>
<dd>For ASCII output mode we write the text string <tt class="docutils literal"><span class="pre">rec</span></tt>. If <tt class="docutils literal"><span class="pre">rec</span></tt>
is NULL then we write the last read header record (and ensures it
starts with #). If binary output mode we quietly skip writing this record.</dd>
<dt><strong>GMT_WRITE_SEGMENT_HEADER</strong></dt>
<dd>For ASCII output mode we use the text string <tt class="docutils literal"><span class="pre">rec</span></tt> as the
segment header. If <tt class="docutils literal"><span class="pre">rec</span></tt> is NULL then we use the current (last
read) segment header record. If binary output mode instead we write
a record composed of NaNs.</dd>
</dl>
<p>The function returns 1 if there was an error associated with the
writing (which is passed back with <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>), otherwise it returns
0.</p>
</div>
<div class="section" id="exporting-a-grid-row">
<h3>3.13.4. Exporting a grid row<a class="headerlink" href="#exporting-a-grid-row" title="Permalink to this headline">¶</a></h3>
<p>If your program must write a grid file row-by-row you must first enable
row-by-row writing with <a class="reference internal" href="#gmt-read-data">GMT_Read_Data</a> and then use the
<tt class="docutils literal"><span class="pre">GMT_Put_Row</span></tt> function in a loop; the prototype is</p>
<blockquote id="gmt-put-row">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Put_Row</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">int</span> <span class="n">row_no</span><span class="p">,</span> <span class="k">struct</span> <span class="n">GMT_GRID</span> <span class="o">*</span><span class="n">G</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">row</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">row</span></tt> is a pointer to a single-precision array with the current
row, <tt class="docutils literal"><span class="pre">G</span></tt> is the grid in question, and <tt class="docutils literal"><span class="pre">row_no</span></tt> is the number of the
current row to be written. Note this value is only considered if the
row-by-row mode was initialized with <tt class="docutils literal"><span class="pre">GMT_GRID_ROW_BY_ROW_MANUAL</span></tt>.</p>
</div>
<div class="section" id="disable-data-export">
<h3>3.13.5. Disable Data Export<a class="headerlink" href="#disable-data-export" title="Permalink to this headline">¶</a></h3>
<p>Once the record-by-record output has completed we disable further output
to prevent accidental writing from occurring (due to poor program
structure, bugs, etc.). We do so by calling <tt class="docutils literal"><span class="pre">GMT_End_IO</span></tt>. This
function disables further record-by-record data export; here, we
obviously pass <tt class="docutils literal"><span class="pre">direction</span></tt> as <tt class="docutils literal"><span class="pre">GMT_OUT</span></tt>.</p>
</div>
</div>
<div class="section" id="destroy-allocated-resources">
<h2>3.14. Destroy allocated resources<a class="headerlink" href="#destroy-allocated-resources" title="Permalink to this headline">¶</a></h2>
<p>If your session imported any data sets into memory then you may
explicitly free this memory once it is no longer needed and before
terminating the session. This is done with the <tt class="docutils literal"><span class="pre">GMT_Destroy_Data</span></tt>
function, whose prototype is</p>
<blockquote id="gmt-destroy-data">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Destroy_Data</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">data</span></tt> is the address of the pointer to a data container.  Note that
when each module completes it will automatically free memory created by
the API; similarly, when the session is destroyed we also automatically
free up memory. Thus, <tt class="docutils literal"><span class="pre">GMT_Destroy_Data</span></tt> is therefore generally only
needed when you wish to directly free up memory to avoid running out of
it. The function returns 1 if there is an error when trying to
free the memory (the error code is passed back with <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>),
otherwise it returns 0.</p>
</div>
<div class="section" id="terminate-a-gmt-session">
<h2>3.15. Terminate a GMT session<a class="headerlink" href="#terminate-a-gmt-session" title="Permalink to this headline">¶</a></h2>
<p>Before your program exits it should properly terminate the
GMT session, which involves a call to</p>
<blockquote id="gmt-destroy-session">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_Destroy_Session</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which simply takes the pointer to the GMT API control structure as its
only arguments. It terminates the GMT machinery and deallocates all
memory used by the GMT API book-keeping. It also unregisters any
remaining resources previously registered with the session. The
GMT API will only close files that it was responsible for opening in
the first place. Finally, the API structure itself is freed so your main
program does not need to do so. The function returns 1 if there
is an error when trying to free the memory (the error code is passed
back with <tt class="docutils literal"><span class="pre">API-&gt;error</span></tt>), otherwise it returns 0.</p>
</div>
</div>
<div class="section" id="the-gmt-fft-interface">
<h1>4. The GMT FFT Interface<a class="headerlink" href="#the-gmt-fft-interface" title="Permalink to this headline">¶</a></h1>
<p>While the i/o options presented so far lets you easily read in a data
table or grid and manipulated them, if you need to do so in the
wavenumber domain then this chapter is for you. Here we outline how to
take the Fourier transform of such data, perform calculations in the
wavenumber domain, and take the inverse transform before writing the
results. To assist programmers we also distribute fully functioning
demonstration programs that takes you through the steps we are about to
discuss; these demo programs may be used as your starting point for
further development.</p>
<div class="section" id="presenting-and-parsing-the-fft-options">
<h2>4.1. Presenting and Parsing the FFT options<a class="headerlink" href="#presenting-and-parsing-the-fft-options" title="Permalink to this headline">¶</a></h2>
<p>Several GMT programs using FFTs present the same unified option and
modifier sets to the user. The API makes these available as well. If
your program needs to present the option usage you can call</p>
<blockquote id="gmt-fft-option">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">GMT_FFT_Option</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">char</span> <span class="n">option</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dim</span><span class="p">,</span>
                             <span class="kt">char</span> <span class="o">*</span><span class="n">string</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>Here, <tt class="docutils literal"><span class="pre">option</span></tt> is the unique character used for this particular
program option (most GMT programs have standardized on using &#8216;N&#8217; but
you are free to choose whatever you want except existing GMT common
options). The <tt class="docutils literal"><span class="pre">dim</span></tt> sets the dimension of the transform, currently you
must choose 1 or 2, while the <tt class="docutils literal"><span class="pre">string</span></tt> is a one-line message that
states what the option does; you should tailor this to your program. If
NULL then a generic message is placed instead.</p>
<p>To parse the user&#8217;s selection you call</p>
<blockquote id="gmt-fft-parse">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="nf">GMT_FFT_Parse</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">char</span> <span class="n">option</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dim</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">args</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which accepts the user&#8217;s string option via <tt class="docutils literal"><span class="pre">args</span></tt>; the other arguments
are the same as those above. The function returns an opaque pointer to a
structure with the chosen parameters.</p>
</div>
<div class="section" id="initializing-the-fft-machinery">
<h2>4.2. Initializing the FFT machinery<a class="headerlink" href="#initializing-the-fft-machinery" title="Permalink to this headline">¶</a></h2>
<p>Before your can take any transforms you must initialize the FFT
machinery. This process involves a series of preparatory steps that are
conveniently performed for you by</p>
<blockquote id="gmt-fft-create">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="nf">GMT_FFT_Create</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">X</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dim</span><span class="p">,</span>
                      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">F</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>Here, <tt class="docutils literal"><span class="pre">X</span></tt> is either your dataset or grid pointer, <tt class="docutils literal"><span class="pre">dim</span></tt> is the
dimension of the transform (1 or 2 only), <tt class="docutils literal"><span class="pre">mode</span></tt> passes various flags to the setup, such as whether
the data is real, imaginary, or complex, and <tt class="docutils literal"><span class="pre">F</span></tt> is the opaque pointer
returned by <a class="reference internal" href="#gmt-fft-parse">GMT_FFT_Parse</a>. Depending on the options you chose to
pass to <a class="reference internal" href="#gmt-fft-parse">GMT_FFT_Parse</a>, the data may have a constant or a trend
removed, reflected and extended by various symmetries, padded and
tapered to desired transform dimensions, and possibly there are
temporary files written out before the transform takes place. See the <a class="reference internal" href="grdfft.html"><em>grdfft</em></a>
man page for a full explanation of the options presented by <a class="reference internal" href="#gmt-fft-option">GMT_FFT_Option</a>.</p>
</div>
<div class="section" id="taking-the-fft">
<h2>4.3. Taking the FFT<a class="headerlink" href="#taking-the-fft" title="Permalink to this headline">¶</a></h2>
<p>Now that everything has been set up you can perform the transform with</p>
<blockquote id="gmt-fft">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="o">*</span><span class="nf">GMT_FFT</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">X</span><span class="p">,</span> <span class="kt">int</span> <span class="n">direction</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">K</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which takes as <tt class="docutils literal"><span class="pre">direction</span></tt> either <tt class="docutils literal"><span class="pre">GMT_FFT_FWD</span></tt> or <tt class="docutils literal"><span class="pre">GMT_FFT_INV</span></tt>. The
mode is used to specify if we pass a real (GMT_FFT_REAL) or complex
(GMT_FFT_COMPLEX) data set, and <tt class="docutils literal"><span class="pre">K</span></tt> is the opaque pointer returned
by <a class="reference internal" href="#gmt-fft-create">GMT_FFT_Create</a>. The transform is performed in place and returned
via <tt class="docutils literal"><span class="pre">X</span></tt>. When done with your manipulations (below) you can call it
again with the inverse flag to recover the corresponding space-domain
version of your data. The FFT is fully normalized so that calling
forward followed by inverse yields the original data set. The information
passed via <tt class="docutils literal"><span class="pre">K</span></tt> determines if a 1-D or 2-D transform takes place; the
key work is done via <tt class="docutils literal"><span class="pre">GMT_FFT_1D</span></tt> or <tt class="docutils literal"><span class="pre">GMT_FFT_2D</span></tt> below.</p>
</div>
<div class="section" id="taking-the-1-d-fft">
<h2>4.4. Taking the 1-D FFT<a class="headerlink" href="#taking-the-1-d-fft" title="Permalink to this headline">¶</a></h2>
<p>A lower-level 1-D FFT is also available via</p>
<blockquote id="gmt-fft-1d">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_FFT_1D</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">uint64_t</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">direction</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which takes as <tt class="docutils literal"><span class="pre">direction</span></tt> either <tt class="docutils literal"><span class="pre">GMT_FFT_FWD</span></tt> or <tt class="docutils literal"><span class="pre">GMT_FFT_INV</span></tt>. The
mode is used to specify if we pass a real (GMT_FFT_REAL) or complex
(GMT_FFT_COMPLEX) data set, and <tt class="docutils literal"><span class="pre">data</span></tt> is the 1-D data array of length
<tt class="docutils literal"><span class="pre">n</span></tt> that we wish
to transform. The transform is performed in place and returned
via <tt class="docutils literal"><span class="pre">data</span></tt>. When done with your manipulations (below) you can call it
again with the inverse flag to recover the corresponding space-domain
version of your data. The 1-D FFT is fully normalized so that calling
forward followed by inverse yields the original data set.  Note that unlike
<tt class="docutils literal"><span class="pre">GMT_FFT</span></tt>, this function does not do any data extension, mirroring, detrending,
etc. but operates directly on the data array given.</p>
</div>
<div class="section" id="taking-the-2-d-fft">
<h2>4.5. Taking the 2-D FFT<a class="headerlink" href="#taking-the-2-d-fft" title="Permalink to this headline">¶</a></h2>
<p>A lower-level 2-D FFT is also available via</p>
<blockquote id="gmt-fft-2d">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">GMT_FFT_2D</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">float</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nx</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ny</span><span class="p">,</span>
               <span class="kt">int</span> <span class="n">direction</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which takes as <tt class="docutils literal"><span class="pre">direction</span></tt> either <tt class="docutils literal"><span class="pre">GMT_FFT_FWD</span></tt> or <tt class="docutils literal"><span class="pre">GMT_FFT_INV</span></tt>. The
mode is used to specify if we pass a real (GMT_FFT_REAL) or complex
(GMT_FFT_COMPLEX) data set, and <tt class="docutils literal"><span class="pre">data</span></tt> is the 2-D data array in
row-major format, with row length <tt class="docutils literal"><span class="pre">nx</span></tt> and column length <tt class="docutils literal"><span class="pre">ny</span></tt>.
The transform is performed in place and returned
via <tt class="docutils literal"><span class="pre">data</span></tt>. When done with your manipulations (below) you can call it
again with the inverse flag to recover the corresponding space-domain
version of your data. The 2-D FFT is fully normalized so that calling
forward followed by inverse yields the original data set.  Note that unlike
<tt class="docutils literal"><span class="pre">GMT_FFT</span></tt>, this function does not do any data extension, mirroring, detrending,
etc. but operates directly on the data array given.</p>
</div>
<div class="section" id="wavenumber-calculations">
<h2>4.6. Wavenumber calculations<a class="headerlink" href="#wavenumber-calculations" title="Permalink to this headline">¶</a></h2>
<p>As your data have been transformed to the wavenumber domain you may wish
to operate on the various values as a function of wavenumber. We will
show how this is done for datasets and grids separately. First, we
present the function that returns an individual wavenumber:</p>
<blockquote id="gmt-fft-wavenumber">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">double</span> <span class="nf">GMT_FFT_Wavenumber</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">uint64_t</span> <span class="n">k</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">K</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">k</span></tt> is the index into the array or grid, <tt class="docutils literal"><span class="pre">mode</span></tt> specifies
which wavenumber we want (it is not used for 1-D transform but for the
2-D transform we can select either the x-wavenumber (0), the
y-wavenumber (1), or the radial wavenumber (2)), and finally the opaque
vector used earlier.</p>
<div class="section" id="d-fft-manipulation">
<h3>4.6.1. 1-D FFT manipulation<a class="headerlink" href="#d-fft-manipulation" title="Permalink to this headline">¶</a></h3>
<p>To be added after gmtfft has been added as new module.</p>
</div>
<div class="section" id="id6">
<h3>4.6.2. 2-D FFT manipulation<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>The number of complex pairs in the grid is given by the header&#8217;s <tt class="docutils literal"><span class="pre">nm</span></tt>
variable, while <tt class="docutils literal"><span class="pre">size</span></tt> will be twice that value as it holds the number
of components. To visit all the complex values and obtain the
corresponding wavenumber we simply need to loop over <tt class="docutils literal"><span class="pre">size</span></tt> and call
<tt class="docutils literal"><span class="pre">GMT_FFT_Wavenumber</span></tt>. This code snippet multiples the complex grid by
the radial wavenumber:</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">uint64_t</span> <span class="n">k</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">Grid</span><span class="o">-&gt;</span><span class="n">header</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">GMT_FFT_Wavenumber</span> <span class="p">(</span><span class="n">API</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">K</span><span class="p">);</span>
    <span class="n">Grid</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="n">wave</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Alternatively, you may choose to be more specific about which components
are real and imaginary (especially if they are to be treated
differently), and set up the loop this way:</p>
<blockquote>
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">uint64_t</span> <span class="n">re</span><span class="p">,</span> <span class="n">im</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">re</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">re</span> <span class="o">&lt;</span> <span class="n">Grid</span><span class="o">-&gt;</span><span class="n">header</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">;</span> <span class="n">re</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">im</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">wave</span> <span class="o">=</span> <span class="n">GMT_FFT_Wavenumber</span> <span class="p">(</span><span class="n">API</span><span class="p">,</span> <span class="n">re</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">K</span><span class="p">);</span>
    <span class="n">Grid</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">re</span><span class="p">]</span> <span class="o">*=</span> <span class="n">wave</span><span class="p">;</span>
    <span class="n">Grid</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">im</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">wave</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="destroying-the-fft-machinery">
<h2>4.7. Destroying the FFT machinery<a class="headerlink" href="#destroying-the-fft-machinery" title="Permalink to this headline">¶</a></h2>
<p>When done you terminate the FFT machinery with</p>
<blockquote id="gmt-fft-destroy">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">double</span> <span class="nf">GMT_FFT_Destroy</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">API</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">K</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>which simply frees up the memory allocated by the FFT machinery.</p>
</div>
</div>
<div class="section" id="fortran-interfaces">
<h1>5. FORTRAN interfaces<a class="headerlink" href="#fortran-interfaces" title="Permalink to this headline">¶</a></h1>
<p>FORTRAN 90 developers who wish to use the GMT API may use the same
API functions as discussed in Chapter 2. As we do not have much (i.e., any) experience
with modern Fortran we are not sure to what extent you are able to access
the members of the various structures, such as the <tt class="docutils literal"><span class="pre">GMT_GRID</span></tt> structure. Thus,
this part will depend on feedback and for the time being is to be considered
preliminary and subject to change.  We encourage you to take contact should you
wish to use the API with your Fortran 90 programs.</p>
<div class="section" id="fortran-77-grid-i-o">
<h2>5.1. FORTRAN 77 Grid i/o<a class="headerlink" href="#fortran-77-grid-i-o" title="Permalink to this headline">¶</a></h2>
<p>Because of a lack of structure pointers we can only provide a low level of
support for Fortran 77. This API is limited to help you inquire, read and write
GMT grids directly from Fortran 77.
To inquire about the range of information in a grid, use</p>
<blockquote id="gmt-f77-readgrdinfo">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="n">GMT_F77_readgrdinfo</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dim</span><span class="p">[],</span> <span class="kt">double</span> <span class="n">limits</span><span class="p">[],</span> <span class="kt">double</span> <span class="n">inc</span><span class="p">[],</span>
                         <span class="kt">char</span> <span class="o">*</span><span class="n">title</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">remark</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">dim</span></tt> returns the grid width, height, and registration, <tt class="docutils literal"><span class="pre">limits</span></tt> returns the min and max values for x, y, and z
as three consecutive pairs, <tt class="docutils literal"><span class="pre">inc</span></tt> returns the x and y increment, the <tt class="docutils literal"><span class="pre">title</span></tt> and <tt class="docutils literal"><span class="pre">remark</span></tt>
returns the values of these strings. The <tt class="docutils literal"><span class="pre">file</span></tt>
argument is the name of the file we wish to inquire about. The function returns 0 unless there is an error.
Note that you must declare your variables so that <tt class="docutils literal"><span class="pre">limits</span></tt> has at least 6 elements and <tt class="docutils literal"><span class="pre">inc</span></tt> and <tt class="docutils literal"><span class="pre">dime</span></tt> have at least 2 each.</p>
<p>To actually read the grid, we use</p>
<blockquote id="gmt-f77-readgrd">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="n">GMT_F77_readgrd</span> <span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="n">array</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dim</span><span class="p">[],</span> <span class="kt">double</span> <span class="n">wesn</span><span class="p">[],</span>
                     <span class="kt">double</span> <span class="n">inc</span><span class="p">[],</span> <span class="kt">char</span> <span class="o">*</span><span class="n">title</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">remark</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">array</span></tt> is the 1-D grid data array, <tt class="docutils literal"><span class="pre">dim</span></tt> returns the grid width, height, and registration,
<tt class="docutils literal"><span class="pre">limits</span></tt> returns the min and max values for x, y, and z, <tt class="docutils literal"><span class="pre">inc</span></tt> returns the x and y increments,
the <tt class="docutils literal"><span class="pre">title</span></tt> and <tt class="docutils literal"><span class="pre">remark</span></tt> returns the values of these strings.  The <tt class="docutils literal"><span class="pre">file</span></tt>
argument is the name of the file we wish to read from.  The function returns 0 unless there is an error.
Note on input, <tt class="docutils literal"><span class="pre">dim[2]</span></tt> can be set to 1 which means we will allocate the array for you; otherwise
we assume space has already been secured.  Also, if <tt class="docutils literal"><span class="pre">dim[3]</span></tt> is set to 1 we will in-place transpose
the array from C-style row-major array order to Fortran column-major array order.</p>
<p>Finally, to write a grid to file you can use</p>
<blockquote id="gmt-f77-writegrd">
<div><div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="n">GMT_F77_writegrd_</span><span class="p">(</span><span class="kt">float</span> <span class="o">*</span><span class="n">array</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dim</span><span class="p">[],</span> <span class="kt">double</span> <span class="n">wesn</span><span class="p">[],</span>
                      <span class="kt">double</span> <span class="n">inc</span><span class="p">[],</span> <span class="kt">char</span> <span class="o">*</span><span class="n">title</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">remark</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>where <tt class="docutils literal"><span class="pre">array</span></tt> is the 1-D grid data array, <tt class="docutils literal"><span class="pre">dim</span></tt> specifies the grid width, height, and registration,
<tt class="docutils literal"><span class="pre">limits</span></tt> may be used to specify a subset (normally, just pass zeros), <tt class="docutils literal"><span class="pre">inc</span></tt> specifies the x and y increments,
the <tt class="docutils literal"><span class="pre">title</span></tt> and <tt class="docutils literal"><span class="pre">remark</span></tt> supplies the values of these strings.  The <tt class="docutils literal"><span class="pre">file</span></tt>
argument is the name of the file we wish to write to.  The function returns 0 unless there is an error.
If <tt class="docutils literal"><span class="pre">dim[3]</span></tt> is set to 1 we will in-place transpose
the array from Fortran column-major array order to C-style row-major array order before writing. Note
this means array will have been transposed when the function returns.</p>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>or via a very confusing and ever-changing myriad of low-level library
functions for bold programmers.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Currently, C/C++, FORTRAN, Matlab and Julia are being tested.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>At the moment, GMT does not have native support for 3-D grids.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td>This may change in later releases.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td>However, there is no thread-support yet.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Introduction</a><ul>
<li><a class="reference internal" href="#preamble">1.1. Preamble</a></li>
<li><a class="reference internal" href="#the-i-o-abstraction-layer">1.2. The i/o abstraction layer</a></li>
<li><a class="reference internal" href="#our-audience">1.3. Our audience</a></li>
<li><a class="reference internal" href="#definitions">1.4. Definitions</a></li>
<li><a class="reference internal" href="#recognized-resources">1.5. Recognized resources</a><ul>
<li><a class="reference internal" href="#data-tables">1.5.1. Data tables</a></li>
<li><a class="reference internal" href="#text-tables">1.5.2. Text tables</a></li>
<li><a class="reference internal" href="#gmt-grids">1.5.3. GMT grids</a></li>
<li><a class="reference internal" href="#gmt-images">1.5.4. GMT images</a></li>
<li><a class="reference internal" href="#cpt-palette-tables">1.5.5. CPT palette tables</a></li>
<li><a class="reference internal" href="#user-data-columns-gmt-vectors">1.5.6. User data columns (GMT vectors)</a></li>
<li><a class="reference internal" href="#user-data-matrices-gmt-matrices">1.5.7. User data matrices (GMT matrices)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#overview-of-the-gmt-c-application-program-interface">2. Overview of the GMT C Application Program Interface</a></li>
<li><a class="reference internal" href="#the-gmt-c-application-program-interface">3. The GMT C Application Program Interface</a><ul>
<li><a class="reference internal" href="#initialize-a-new-gmt-session">3.1. Initialize a new GMT session</a></li>
<li><a class="reference internal" href="#register-input-or-output-resources">3.2. Register input or output resources</a><ul>
<li><a class="reference internal" href="#resource-registration">3.2.1. Resource registration</a></li>
<li><a class="reference internal" href="#object-id-encoding">3.2.2. Object ID encoding</a></li>
<li><a class="reference internal" href="#resource-initialization">3.2.3. Resource initialization</a></li>
<li><a class="reference internal" href="#dimension-parameters-for-user-1-d-column-vectors">3.2.4. Dimension parameters for user 1-D column vectors</a></li>
<li><a class="reference internal" href="#dimension-parameters-for-user-2-d-table-arrays">3.2.5. Dimension parameters for user 2-D table arrays</a></li>
</ul>
</li>
<li><a class="reference internal" href="#create-empty-resources">3.3. Create empty resources</a></li>
<li><a class="reference internal" href="#duplicate-resources">3.4. Duplicate resources</a></li>
<li><a class="reference internal" href="#get-resource-id">3.5. Get resource ID</a></li>
<li><a class="reference internal" href="#import-data">3.6. Import Data</a><ul>
<li><a class="reference internal" href="#enable-data-import">3.6.1. Enable Data Import</a></li>
<li><a class="reference internal" href="#import-a-data-set">3.6.2. Import a data set</a><ul>
<li><a class="reference internal" href="#import-from-a-file-stream-or-handle">3.6.2.1. Import from a file, stream, or handle</a></li>
<li><a class="reference internal" href="#import-from-a-memory-location">3.6.2.2. Import from a memory location</a></li>
<li><a class="reference internal" href="#retrieve-an-allocated-result">3.6.2.3. Retrieve an allocated result</a></li>
</ul>
</li>
<li><a class="reference internal" href="#importing-a-data-record">3.6.3. Importing a data record</a></li>
<li><a class="reference internal" href="#examining-record-status">3.6.4. Examining record status</a></li>
<li><a class="reference internal" href="#importing-a-grid-row">3.6.5. Importing a grid row</a></li>
<li><a class="reference internal" href="#disable-data-import">3.6.6. Disable Data Import</a></li>
</ul>
</li>
<li><a class="reference internal" href="#manipulate-data">3.7. Manipulate data</a><ul>
<li><a class="reference internal" href="#manipulate-grids">3.7.1. Manipulate grids</a></li>
<li><a class="reference internal" href="#manipulate-data-tables">3.7.2. Manipulate data tables</a></li>
<li><a class="reference internal" href="#manipulate-text-tables">3.7.3. Manipulate text tables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#message-and-verbose-reporting">3.8. Message and Verbose Reporting</a></li>
<li><a class="reference internal" href="#presenting-and-accessing-gmt-options">3.9. Presenting and accessing GMT options</a><ul>
<li><a class="reference internal" href="#display-usage-syntax-for-gmt-common-options">3.9.1. Display usage syntax for GMT common options</a></li>
<li><a class="reference internal" href="#parsing-the-gmt-common-options">3.9.2. Parsing the GMT common options</a></li>
<li><a class="reference internal" href="#inquiring-about-the-gmt-common-options">3.9.3. Inquiring about the GMT common options</a></li>
<li><a class="reference internal" href="#parsing-text-values">3.9.4. Parsing text values</a></li>
<li><a class="reference internal" href="#inquiring-about-a-gmt-default-parameter">3.9.5. Inquiring about a GMT default parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#prepare-module-options">3.10. Prepare module options</a><ul>
<li><a class="reference internal" href="#set-program-options-via-text-array-arguments">3.10.1. Set program options via text array arguments</a></li>
<li><a class="reference internal" href="#set-program-options-via-text-command">3.10.2. Set program options via text command</a></li>
<li><a class="reference internal" href="#set-program-options-via-linked-structures">3.10.3. Set program options via linked structures</a></li>
<li><a class="reference internal" href="#convert-between-text-and-linked-structures">3.10.4. Convert between text and linked structures</a></li>
<li><a class="reference internal" href="#manage-the-linked-list-of-options">3.10.5. Manage the linked list of options</a><ul>
<li><a class="reference internal" href="#make-a-new-option-structure">3.10.5.1. Make a new option structure</a></li>
<li><a class="reference internal" href="#append-an-option-to-the-linked-list">3.10.5.2. Append an option to the linked list</a></li>
<li><a class="reference internal" href="#find-an-option-in-the-linked-list">3.10.5.3. Find an option in the linked list</a></li>
<li><a class="reference internal" href="#update-an-existing-option-in-the-list">3.10.5.4. Update an existing option in the list</a></li>
<li><a class="reference internal" href="#delete-an-existing-option-in-the-linked-list">3.10.5.5. Delete an existing option in the linked list</a></li>
<li><a class="reference internal" href="#specify-a-file-via-an-linked-option">3.10.5.6. Specify a file via an linked option</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#calling-a-gmt-module">3.11. Calling a GMT module</a></li>
<li><a class="reference internal" href="#adjusting-headers-and-comments">3.12. Adjusting headers and comments</a></li>
<li><a class="reference internal" href="#exporting-data">3.13. Exporting Data</a><ul>
<li><a class="reference internal" href="#enable-data-export">3.13.1. Enable Data Export</a></li>
<li><a class="reference internal" href="#exporting-a-data-set">3.13.2. Exporting a data set</a><ul>
<li><a class="reference internal" href="#exporting-a-data-set-to-a-file-stream-or-handle">3.13.2.1. Exporting a data set to a file, stream, or handle</a></li>
<li><a class="reference internal" href="#exporting-a-data-set-to-memory">3.13.2.2. Exporting a data set to memory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exporting-a-data-record">3.13.3. Exporting a data record</a></li>
<li><a class="reference internal" href="#exporting-a-grid-row">3.13.4. Exporting a grid row</a></li>
<li><a class="reference internal" href="#disable-data-export">3.13.5. Disable Data Export</a></li>
</ul>
</li>
<li><a class="reference internal" href="#destroy-allocated-resources">3.14. Destroy allocated resources</a></li>
<li><a class="reference internal" href="#terminate-a-gmt-session">3.15. Terminate a GMT session</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-gmt-fft-interface">4. The GMT FFT Interface</a><ul>
<li><a class="reference internal" href="#presenting-and-parsing-the-fft-options">4.1. Presenting and Parsing the FFT options</a></li>
<li><a class="reference internal" href="#initializing-the-fft-machinery">4.2. Initializing the FFT machinery</a></li>
<li><a class="reference internal" href="#taking-the-fft">4.3. Taking the FFT</a></li>
<li><a class="reference internal" href="#taking-the-1-d-fft">4.4. Taking the 1-D FFT</a></li>
<li><a class="reference internal" href="#taking-the-2-d-fft">4.5. Taking the 2-D FFT</a></li>
<li><a class="reference internal" href="#wavenumber-calculations">4.6. Wavenumber calculations</a><ul>
<li><a class="reference internal" href="#d-fft-manipulation">4.6.1. 1-D FFT manipulation</a></li>
<li><a class="reference internal" href="#id6">4.6.2. 2-D FFT manipulation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#destroying-the-fft-machinery">4.7. Destroying the FFT machinery</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fortran-interfaces">5. FORTRAN interfaces</a><ul>
<li><a class="reference internal" href="#fortran-77-grid-i-o">5.1. FORTRAN 77 Grid i/o</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="api.html"
                        title="previous chapter">GMT_API</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/GMT_API.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="api.html" title="GMT_API"
             >previous</a> </li>
  <li><a href="/projects/gmt/wiki/Documentation">Project Home</a>  &raquo;</li>
  
        <li><a href="index.html">GMT 5.1.2 documentation</a> &raquo;</li>

          <li><a href="api.html" >GMT_API</a> &raquo;</li>
<li class="right">
<form class="search" accept-charset="UTF-8" action="search.html" method="get">
  <div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"></div>
  <label for="q">
    <a class="search" href="search.html" accesskey="s" original-title="">Search:</a>
  </label>
  <input accesskey="f" class="small" id="q" name="q" size="20" type="text">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form></li>
   

      </ul>
    </div>
<div class="footer">
    &copy; Copyright 2015, P. Wessel, W. H. F. Smith, R. Scharroo, J. Luis, and F. Wobbe.
  Last updated on May 04, 2015.
  Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
  <br />Theme based on <a href="http://readthedocs.org/">Read The Docs</a>

</div>


  </body>
</html>