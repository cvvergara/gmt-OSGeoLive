<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    

    <title>(32) Draping an image over topography &mdash; GMT 5.1.1 documentation</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>


    
    <link rel="stylesheet" href="../_static/rtd.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/searchtools.js"></script>
    <script type="text/javascript" src="../../_static/rtd-sidebar.js"></script>
    <link rel="top" title="GMT 5.1.1 documentation" href="../index.html" />
    <link rel="up" title="The GMT historical collection" href="../Gallery.html" />
    <link rel="next" title="(33) Stacking automatically generated cross-profiles" href="ex33.html" />
    <link rel="prev" title="(31) Using non-default fonts in PostScript" href="ex31.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ex33.html" title="(33) Stacking automatically generated cross-profiles"
             accesskey="N">next</a> </li>
        <li class="right" >
          <a href="ex31.html" title="(31) Using non-default fonts in PostScript"
             accesskey="P">previous</a> </li>
  <li><a href="/projects/gmt/wiki/Documentation">Project Home</a>  &raquo;</li>
  
        <li><a href="../index.html">GMT 5.1.1 documentation</a> &raquo;</li>

          <li><a href="../Gallery.html" accesskey="U">The GMT historical collection</a> &raquo;</li>
<li class="right">
<form class="search" accept-charset="UTF-8" action="search.html" method="get">
  <div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"></div>
  <label for="q">
    <a class="search" href="search.html" accesskey="s" original-title="">Search:</a>
  </label>
  <input accesskey="f" class="small" id="q" name="q" size="20" type="text">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form></li>
   

      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="draping-an-image-over-topography">
<span id="example-32"></span><h1>(32) Draping an image over topography<a class="headerlink" href="#draping-an-image-over-topography" title="Permalink to this headline">¶</a></h1>
<p>In some cases, it is nice to &#8220;drape&#8221; an arbitrary image over a
topographic map. We have already seen how to use
<a class="reference internal" href="../psimage.html"><em>psimage</em></a> to plot an image anywhere in
out plot. But here are aim is different, we want to manipulate an image
to shade it and plot it in 3-D over topography. This example was
originally created by Stephan Eickschen for a flyer emphasizing the
historical economical and cultural bond between Brussels, Maastricht and
Bonn. Obviously, the flag of the European Union came to mind as a good
&#8220;background&#8221;.</p>
<p>To avoid adding large files to this example, some steps have been
already done. First we get the EU flag directly from the web and convert
it to a grid with values ranging from 0 to 255, where the higher values
will become yellow and the lower values blue. This use of
<a class="reference internal" href="../grdreformat.html"><em>grdreformat</em></a> requires GDAL support.
<a class="reference internal" href="../grdedit.html"><em>grdedit</em></a> then adds the right grid dimension.</p>
<p>The second step is to reformat the GTOPO30 DEM file to a netCDF grid as
well and then subsample it at the same pixels as the EU flag. We then
illuminate the topography grid so we can use it later to emphasize the
topography. The colors that we will use are those of the proper flag.
Lower values will become blue and the upper values yellow.</p>
<p>The call the <a class="reference internal" href="../grdview.html"><em>grdview</em></a> plots a
topography map of northwest continental Europe, with the flagged draped
over it and with shading to show the little topography there is.
<a class="reference internal" href="../pscoast.html"><em>pscoast</em></a> is used in conjunction with
<a class="reference internal" href="../grdtrack.html"><em>grdtrack</em></a> and <a class="reference internal" href="../psxyz.html"><em>psxyz</em></a> to plot
borders &#8220;at altitude&#8221;. Something similar is done at the end to plot some
symbols and names for cities.</p>
<p>The script produces the plot in Figure [fig:example<sub>3</sub>2]. Note
that the PNG image of the flag can be downloaded directly in the call
the <a class="reference internal" href="../grdreformat.html"><em>grdreformat</em></a>, but we have
commented that out in the example because it requires compilation with
GDAL support. You will also see the
<a class="reference internal" href="../grdcut.html"><em>grdcut</em></a> command commented out because we
did not want to store the 58 MB DEM file, whose location is mentioned in the script.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c">#		GMT EXAMPLE 32</span>
<span class="c">#</span>
<span class="c"># Purpose:	Illustrate draping of an image over topography</span>
<span class="c"># GMT progs:	grdcut, grdedit, grdgradient, grdreformat, grdtrack, grdview</span>
<span class="c"># GMT progs:	pscoast, pstext, psxyz</span>
<span class="c"># Unix progs:	cat, rm</span>
<span class="c"># Credits:	Original by Stephan Eickschen</span>
<span class="c">#</span>
<span class="nv">ps</span><span class="o">=</span>example_32.ps

<span class="c"># Here we get and convert the flag of Europe directly from the web through grdreformat using</span>
<span class="c"># GDAL support. We take into account the dimension of the flag (1000x667 pixels)</span>
<span class="c"># for a ratio of 3x2.</span>
<span class="c"># Because GDAL support will not be standard for most users, we have stored</span>
<span class="c"># the result, euflag.nc in this directory.</span>

<span class="nv">Rflag</span><span class="o">=</span>-R3/9/50/54
<span class="c"># gmt grdreformat \</span>
<span class="c">#   http://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/Flag_of_Europe.svg/1000px-Flag_of_Europe.svg.png=gd \</span>
<span class="c">#   euflag.nc=ns</span>
<span class="c"># gmt grdedit euflag.nc -fg $Rflag</span>

<span class="c"># Now get the topography for the same area from GTOPO30 and store it as topo.nc.</span>
<span class="c"># The DEM file comes from http://eros.usgs.gov/#/Find_Data/Products_and_Data_Available/gtopo30/w020n90</span>
<span class="c"># We make an gradient grid as well, which we will use to &quot;illuminate&quot; the flag.</span>

<span class="c"># gmt grdcut W020N90.DEM $Rflag -Gtopo.nc=ns</span>
gmt grdgradient topo.nc -A0/270 -Gillum.nc -Ne0.6

<span class="c"># The color map assigns &quot;Reflex Blue&quot; to the lower half of the 0-255 range and</span>
<span class="c"># &quot;Yellow&quot; to the upper half.</span>
cat <span class="s">&lt;&lt; EOF &gt; euflag.cpt</span>
<span class="s">0	0/51/153	127	0/51/153</span>
<span class="s">127	255/204/0	255	255/204/0</span>
<span class="s">EOF</span>

<span class="c"># The next step is the plotting of the image.</span>
<span class="c"># We use gmt grdview to plot the topography, euflag.nc to give the color, and illum.nc to give</span>
<span class="c"># the shading.</span>

<span class="nv">Rplot</span><span class="o">=</span><span class="nv">$Rflag</span>/-10/790
gmt grdview topo.nc -JM13c <span class="nv">$Rplot</span> -Ceuflag.cpt -Geuflag.nc -Iillum.nc -Qc -JZ1c -p157.5/30 -P -K &gt; <span class="nv">$ps</span>

<span class="c"># We now add borders. Because we have a 3-D plot, we want them to be plotted &quot;at elevation&quot;.</span>
<span class="c"># So we write out the borders, pipe them through grdtack and then plot them with psxyz.</span>

gmt pscoast <span class="nv">$Rflag</span> -Df -M -N1 | gmt grdtrack -Gtopo.nc -sa | gmt psxyz <span class="nv">$Rplot</span> -J -JZ -p -W1p,white <span class="se">\</span>
	-O -K &gt;&gt; <span class="nv">$ps</span>

<span class="c"># Finally, we add dots and names for three cities.</span>
<span class="c"># Again, gmt grdtrack is used to put the dots &quot;at elevation&quot;.</span>

cat <span class="s">&lt;&lt; EOF &gt; cities.txt</span>
<span class="s">05:41:27 50:51:05 Maastricht</span>
<span class="s">04:21:00 50:51:00 Bruxelles</span>
<span class="s">07:07:03 50:43:09 Bonn</span>
<span class="s">EOF</span>

gmt grdtrack -Gtopo.nc -sa cities.txt | gmt psxyz -i0,1,3 <span class="nv">$Rplot</span> -J -JZ -p -Sc7p -W1p,white -Gred <span class="se">\</span>
	-K -O &gt;&gt; <span class="nv">$ps</span>
gmt pstext <span class="nv">$Rplot</span> -J -JZ -p -F+f12p,Helvetica-Bold,red+jRM -Dj0.1i/0.0i -O cities.txt &gt;&gt; <span class="nv">$ps</span>

<span class="c"># cleanup</span>

rm -f gmt.conf euflag.cpt illum.nc cities.txt
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/example_32.png"><img alt="../_images/example_32.png" src="../_images/example_32.png" style="width: 500px;" /></a>
<p class="caption">Draping an image over topography.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="ex31.html"
                        title="previous chapter">(31) Using non-default fonts in PostScript</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ex33.html"
                        title="next chapter">(33) Stacking automatically generated cross-profiles</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/gallery/ex32.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ex33.html" title="(33) Stacking automatically generated cross-profiles"
             >next</a> </li>
        <li class="right" >
          <a href="ex31.html" title="(31) Using non-default fonts in PostScript"
             >previous</a> </li>
  <li><a href="/projects/gmt/wiki/Documentation">Project Home</a>  &raquo;</li>
  
        <li><a href="../index.html">GMT 5.1.1 documentation</a> &raquo;</li>

          <li><a href="../Gallery.html" >The GMT historical collection</a> &raquo;</li>
<li class="right">
<form class="search" accept-charset="UTF-8" action="search.html" method="get">
  <div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"></div>
  <label for="q">
    <a class="search" href="search.html" accesskey="s" original-title="">Search:</a>
  </label>
  <input accesskey="f" class="small" id="q" name="q" size="20" type="text">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form></li>
   

      </ul>
    </div>
<div class="footer">
    &copy; Copyright 2014, P. Wessel, W. H. F. Smith, R. Scharroo, J. Luis, and F. Wobbe.
  Last updated on Mar 01, 2014.
  Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.1.
  <br />Theme based on <a href="http://readthedocs.org/">Read The Docs</a>

</div>


  </body>
</html>